<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>c&#43;&#43;反汇编揭秘 - 学习记录</title><meta name="author" content="cjt">
<meta name="author-link" content="">
<meta name="description" content="4. 观察各种表达式的求值过程 4.1 加法 release版 1 2 3 4 5 6 7 8 9 10 11 #include &lt;stdio.h&gt; int main(int argc, char* argv[]) { int n1 = argc; int n2 = argc; //复写传播：n2等价于引用argc，" /><meta name="keywords" content='c/c&#43;&#43;' /><meta itemprop="name" content="c&#43;&#43;反汇编揭秘">
<meta itemprop="description" content="4. 观察各种表达式的求值过程 4.1 加法 release版 1 2 3 4 5 6 7 8 9 10 11 #include &lt;stdio.h&gt; int main(int argc, char* argv[]) { int n1 = argc; int n2 = argc; //复写传播：n2等价于引用argc，"><meta itemprop="datePublished" content="2023-02-07T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-02-07T00:00:00+00:00" />
<meta itemprop="wordCount" content="28548">
<meta itemprop="keywords" content="c/c&#43;&#43;," /><meta property="og:title" content="c&#43;&#43;反汇编揭秘" />
<meta property="og:description" content="4. 观察各种表达式的求值过程 4.1 加法 release版 1 2 3 4 5 6 7 8 9 10 11 #include &lt;stdio.h&gt; int main(int argc, char* argv[]) { int n1 = argc; int n2 = argc; //复写传播：n2等价于引用argc，" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-02-07T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="c&#43;&#43;反汇编揭秘"/>
<meta name="twitter:description" content="4. 观察各种表达式的求值过程 4.1 加法 release版 1 2 3 4 5 6 7 8 9 10 11 #include &lt;stdio.h&gt; int main(int argc, char* argv[]) { int n1 = argc; int n2 = argc; //复写传播：n2等价于引用argc，"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98/" /><link rel="prev" href="https://cui-jiang-tao.github.io/posts/%E6%BB%B4%E6%B0%B4%E4%B8%89%E6%9C%9F/" /><link rel="next" href="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%B0%8F%E5%B7%A5%E5%85%B7/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "c++反汇编揭秘",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/cui-jiang-tao.github.io\/posts\/c\u002b\u002b%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98\/"
    },"genre": "posts","keywords": "c\/c\u002b\u002b","wordcount":  28548 ,
    "url": "https:\/\/cui-jiang-tao.github.io\/posts\/c\u002b\u002b%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98\/","datePublished": "2023-02-07T00:00:00+00:00","dateModified": "2023-02-07T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "cjt"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="学习记录"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span><span id="typeit-header-desktop" class="typeit"></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="学习记录"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span><span id="typeit-header-title-mobile" class="typeit"></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><main class="container" data-page-style="wide"><aside class="toc" id="toc-auto"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">
        <span>c&#43;&#43;反汇编揭秘</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img
    class="lazyload avatar"
    src="/svg/loading.min.svg"
    data-src="https://www.gravatar.com/avatar/736cc0685dbd22dd674add9c481fc755?s=32&amp;d="
    data-srcset="https://www.gravatar.com/avatar/736cc0685dbd22dd674add9c481fc755?s=32&amp;d=, https://www.gravatar.com/avatar/736cc0685dbd22dd674add9c481fc755?s=32&amp;d= 1.5x, https://www.gravatar.com/avatar/736cc0685dbd22dd674add9c481fc755?s=32&amp;d= 2x"
    data-sizes="auto"
    alt="cjt"
    title="cjt"/>&nbsp;cjt</span></span>
          <span class="post-category">included in <a href="/categories/%E9%80%86%E5%90%91/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 逆向</a></span></div>
      <div class="post-meta-line"><span title=2023-02-07&#32;00:00:00><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-02-07">2023-02-07</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i> 28548 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden="true"></i> 57 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#4-观察各种表达式的求值过程">4. 观察各种表达式的求值过程</a>
      <ul>
        <li><a href="#41-加法">4.1 加法</a></li>
        <li><a href="#42-减法">4.2 减法</a></li>
        <li><a href="#43-乘法">4.3 乘法</a></li>
        <li><a href="#44除法">4.4除法</a></li>
        <li><a href="#45-取模">4.5 取模</a></li>
        <li><a href="#46-条件跳转指令表">4.6 条件跳转指令表</a></li>
        <li><a href="#47-条件表达式">4.7 条件表达式</a>
          <ul>
            <li><a href="#471-相差为1">4.7.1 相差为1</a></li>
            <li><a href="#472-相差大于1">4.7.2 相差大于1</a></li>
            <li><a href="#473-变量表达式">4.7.3 变量表达式</a></li>
            <li><a href="#474-表达式无优化使用分支">4.7.4 表达式无优化使用分支</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#5-流程控制语句的识别">5. 流程控制语句的识别</a>
      <ul>
        <li><a href="#51-if语句">5.1 if语句</a></li>
        <li><a href="#52-if-else语句">5.2 if else语句</a></li>
        <li><a href="#53-switch语句">5.3 switch语句</a>
          <ul>
            <li><a href="#531-分支少于4个">5.3.1 分支少于4个</a></li>
            <li><a href="#532-分支大于4个且值连续">5.3.2 分支大于4个且值连续</a></li>
            <li><a href="#533-分支大于4个值不连续且最大case值和case值的差小于256">5.3.3 分支大于4个，值不连续，且最大case值和case值的差小于256</a></li>
            <li><a href="#534-分支大于4个值不连续且最大case值和case值的差大于256">5.3.4 分支大于4个，值不连续，且最大case值和case值的差大于256</a></li>
          </ul>
        </li>
        <li><a href="#54-do-while语句">5.4 do while语句</a></li>
        <li><a href="#55-while语句">5.5 while语句</a></li>
        <li><a href="#56-for语句">5.6 for语句</a></li>
      </ul>
    </li>
    <li><a href="#6-函数的工作原理">6. 函数的工作原理</a>
      <ul>
        <li><a href="#61-栈帧的形成和关闭">6.1 栈帧的形成和关闭</a></li>
        <li><a href="#62-各种调用方式的考察">6.2 各种调用方式的考察</a></li>
        <li><a href="#63-函数的参数">6.3 函数的参数</a></li>
      </ul>
    </li>
    <li><a href="#7-变量在内存中的位置和访问方式">7. 变量在内存中的位置和访问方式</a>
      <ul>
        <li><a href="#71-全局变量和局部变量的区别">7.1 全局变量和局部变量的区别</a></li>
        <li><a href="#72-局部静态变量的工作方式">7.2 局部静态变量的工作方式</a></li>
        <li><a href="#73-堆变量">7.3 堆变量</a></li>
      </ul>
    </li>
    <li><a href="#8-数组和指针的寻址">8. 数组和指针的寻址</a>
      <ul>
        <li><a href="#81-数组在函数内">8.1 数组在函数内</a></li>
        <li><a href="#82-数组作为参数">8.2 数组作为参数</a>
          <ul>
            <li><a href="#821-strlen函数">8.2.1 strlen()函数</a></li>
            <li><a href="#822-strcpy函数">8.2.2 strcpy()函数</a></li>
          </ul>
        </li>
        <li><a href="#83-存放指针类型数组的数组">8.3 存放指针类型数组的数组</a></li>
        <li><a href="#84-函数指针">8.4 函数指针</a></li>
      </ul>
    </li>
    <li><a href="#9-结构体和类">9. 结构体和类</a>
      <ul>
        <li><a href="#91-对象的内存布局">9.1 对象的内存布局</a></li>
        <li><a href="#92-this指针">9.2 this指针</a></li>
        <li><a href="#93-对象作为函数参数">9.3 对象作为函数参数</a></li>
        <li><a href="#94-对象作为返回值">9.4 对象作为返回值</a></li>
      </ul>
    </li>
    <li><a href="#10-构造函数和析构函数">10. 构造函数和析构函数</a>
      <ul>
        <li><a href="#101-构造函数的出现时机">10.1 构造函数的出现时机</a>
          <ul>
            <li><a href="#1011-局部对象">10.1.1 局部对象</a></li>
            <li><a href="#1012-堆对象">10.1.2 堆对象</a></li>
            <li><a href="#1013-参数对象">10.1.3 参数对象</a></li>
            <li><a href="#1014-返回对象">10.1.4 返回对象</a></li>
          </ul>
        </li>
        <li><a href="#102-析构对象的出现时机">10.2 析构对象的出现时机</a>
          <ul>
            <li><a href="#1021-局部对象">10.2.1 局部对象</a></li>
            <li><a href="#1022-堆对象">10.2.2 堆对象</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#11-虚函数">11. 虚函数</a>
      <ul>
        <li><a href="#111-虚函数的机制">11.1 虚函数的机制</a>
          <ul>
            <li><a href="#1111-默认构造函数初始化虚表指针的过程">11.1.1 默认构造函数初始化虚表指针的过程</a></li>
            <li><a href="#1112-调用自身类的虚函数">11.1.2 调用自身类的虚函数</a></li>
            <li><a href="#1113-析构函数分析">11.1.3 析构函数分析</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#12-从内存角度看继承和多重继承">12. 从内存角度看继承和多重继承</a>
      <ul>
        <li><a href="#121-识别类与类之间的关系">12.1 识别类与类之间的关系</a></li>
        <li><a href="#122-多重继承">12.2 多重继承</a></li>
        <li><a href="#123-抽象类">12.3 抽象类</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 id="4-观察各种表达式的求值过程">4. 观察各种表达式的求值过程</h2>
<h3 id="41-加法">4.1 加法</h3>
<p>release版</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span> 
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>         <span class="c1">//复写传播：n2等价于引用argc， n2则被删除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>         <span class="c1">//下一句n1重新赋值了，所以这句被删除了   
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">n1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>            <span class="c1">//常量折叠：n1 = 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">;</span>        <span class="c1">//常量传播和复写传播： n1 = 3 + argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;n1 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">F</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="42-减法">4.2 减法</h3>
<p>release版</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">-</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">n2</span><span class="p">;</span>       <span class="c1">//n1 = n1 -95 - n2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d </span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n2</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 = %d </span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">-</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">95</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n2</span>              <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">5</span><span class="no">Fh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B2</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B3</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN1D</span>     <span class="c1">; &#34;n1 = %d \r\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B8</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BD</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C0</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C2</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C4</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="43-乘法">4.3 乘法</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">argc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * 15 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="mi">15</span><span class="p">);</span>       <span class="c1">//变量乘常量 ( 常量值为非 2 的幂 )
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * 16 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>       <span class="c1">//变量乘常量 ( 常量值为 2 的幂 )
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;2 * 2 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>           <span class="c1">//两常量相乘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n2 * 4 + 5 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n2</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> <span class="c1">//混合运算
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * n2 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">n2</span><span class="p">);</span>       <span class="c1">//两变量相乘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * 15 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * 16 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;2 * 2 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n2 * 4 + 5 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">argc</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n1 * n2 = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">*</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401044</span>                 <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">shl</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">C</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;n1 * 15 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">shl</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN116D</span>   <span class="c1">; &#34;n1 * 16 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401064</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401069</span>                 <span class="nf">push</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">a22D</span>     <span class="c1">; &#34;2 * 2 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401070</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401075</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ds</span><span class="p">:</span><span class="mi">5</span><span class="p">[</span><span class="no">esi</span><span class="p">*</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN245D</span>   <span class="c1">; &#34;n2 * 4 + 5 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401082</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401087</span>                 <span class="nf">imul</span>    <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN1N2D</span>   <span class="c1">; &#34;n1 * n2 = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401095</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">28</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401098</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">A</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">B</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">C</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">C</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="44除法">4.4除法</h3>
<p>常用指令</p>
<ul>
<li>cdq：把eax的最高位填充到edx，如果<code>eax ≥ 0</code>，<code>edx = 0</code>，如果<code>eax ＜ 0</code>，<code>edx = 0xFFFFFFFF</code></li>
<li>sar：算术右移</li>
<li>shr：逻辑右移</li>
<li>neg：将操作数取反+1</li>
<li>div：无符号数除法</li>
<li>idiv：有符号除法</li>
<li>mul：无符号数乘法</li>
<li>imul：有符号数乘法</li>
</ul>
<h3 id="45-取模">4.5 取模</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">8</span><span class="p">);</span> <span class="c1">//变量模常量，常量为2的幂
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">9</span><span class="p">);</span> <span class="c1">//变量模常量，常量为非2的幂
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">%</span> <span class="mi">9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">1040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401044</span>                 <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">esi</span>        <span class="c1">; = argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">and</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">80000007</span><span class="no">h</span>  <span class="c1">; eax = argc &amp; 7 (最高位1为了检查负数)，统计低位保留多少1，即可得到k值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">E</span>                 <span class="no">jns</span>     <span class="no">short</span> <span class="no">loc_401055</span> <span class="c1">; if(argc &gt;= 0) 则跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">dec</span>     <span class="no">eax</span>             <span class="c1">; 将寄存器eax中的值减1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401051</span>                 <span class="nf">or</span>      <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">FFFFFFF8h</span> <span class="c1">; 统计低位保存多少个0，即可得到k值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">inc</span>     <span class="no">eax</span>             <span class="c1">; if(argc &lt; 0) eax = ((argc &amp; 7) - 1 | -7) + 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401055</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401055</span> <span class="nl">loc_401055:</span>                             <span class="c1">; CODE XREF: _main+E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401056</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">38</span><span class="no">E38E39h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401065</span>                 <span class="nf">imul</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">sar</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401069</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">B</span>                 <span class="no">shr</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span><span class="no">Fh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401070</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="no">eax</span><span class="p">*</span><span class="mi">8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401073</span>                 <span class="nf">sub</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401075</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401076</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401080</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401083</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401085</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401086</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401087</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401087</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>总结：</p>
<ol>
<li>第一种对2的k次方取余：<code>and eax,80000007h</code>，去掉最高位保留低位，统计低位一个保留了多少1(7的二进制位<code>0111</code>，保留了3个1)，即可得到k的值为3，然后得到结果：2^3 = 8</li>
<li>第二种对非2的k次方求余：<code>[eax+eax*8] = eax*9</code>，即可得到结果9</li>
</ol>
<h3 id="46-条件跳转指令表">4.6 条件跳转指令表</h3>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="../../imgs/x86/jump_indicator.png"
    data-srcset="../../imgs/x86/jump_indicator.png, ../../imgs/x86/jump_indicator.png 1.5x, ../../imgs/x86/jump_indicator.png 2x"
    data-sizes="auto"
    alt="&amp;ldquo;条件跳转指令表&amp;rdquo;"
    title="&amp;ldquo;条件跳转指令表&amp;rdquo;"/></p>
<h3 id="47-条件表达式">4.7 条件表达式</h3>
<h4 id="471-相差为1">4.7.1 相差为1</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">?</span> <span class="mi">5</span> <span class="o">:</span> <span class="mi">6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401045</span>                 <span class="nf">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">setnz</span>   <span class="no">al</span>              <span class="c1">; if(argc == 5) a1 = 0, else a1 = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">C</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">5</span>          <span class="c1">; 结合前面，可得：if(argc == 5) eax = 5, else exa = 5 + 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\r\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="472-相差大于1">4.7.2 相差大于1</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">?</span> <span class="mi">4</span> <span class="o">:</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">],</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401051</span>                 <span class="nf">cmovz</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">ecx</span>        <span class="c1">; if(ZF == 1) eax = ecx = 4, else eax = 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\r\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">F</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401062</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401064</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401065</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401065</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="473-变量表达式">4.7.3 变量表达式</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">?</span> <span class="nl">n1</span> <span class="p">:</span> <span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n1</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n2</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">n1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n1</span>              <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n2</span>              <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401096</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401099</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">A</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d %d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A3</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A8</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AB</span>                 <span class="no">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">cmovnz</span>  <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n1</span><span class="p">]</span>   <span class="c1">; if(argc != 0) eax = n1, else eax = n2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B3</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B4</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aD</span>       <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B9</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BE</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C1</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C3</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C6</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C6</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="474-表达式无优化使用分支">4.7.4 表达式无优化使用分支</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span> <span class="o">?</span> <span class="nl">n1</span> <span class="p">:</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n2</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n1</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d %d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n2</span>              <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n1</span>              <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401096</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401099</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">A</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d %d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A3</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A8</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AB</span>                 <span class="no">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_4010C8</span> <span class="c1">; avgc == 0 的流程
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B1</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n1</span><span class="p">]</span>   <span class="c1">; avgc != 0 的流程
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B4</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aD</span>       <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BA</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C2</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C4</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C6</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C7</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C8</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C8</span> <span class="no">loc_4010C8</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+1F↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C8</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n2</span><span class="p">]</span>   <span class="c1">; avgc == 0 的流程
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CB</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CE</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aD</span>       <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D4</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D9</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DC</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DE</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E0</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E1</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E1</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="5-流程控制语句的识别">5. 流程控制语句的识别</h2>
<h3 id="51-if语句">5.1 if语句</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc == 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">argc</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc == 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F5↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_401056</span> <span class="c1">; if(argc != 0)  则跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;argc == 0&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">E</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401053</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401056</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401056</span> <span class="nl">loc_401056:</span>                             <span class="c1">; CODE XREF: _main+7↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401056</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401058</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过汇编可以发现，if语句转换的条件跳转指令与if语句的判断结果是相反的。</p>
<p>根据这一特性，如果将if语句中的比较条件<code>argc == 0</code>修改为<code>if(argc &gt; 0)</code>，则其对应的汇编语言使用的条件跳转指令会是“小于等于0”。</p>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F5↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">test</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; 检测eax的值是否为零
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401048</span>                 <span class="nf">jle</span>     <span class="no">short</span> <span class="no">loc_401058</span> <span class="c1">; if(argc &lt;= 0) 则跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401058</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401058</span> <span class="nl">loc_401058:</span>                             <span class="c1">; CODE XREF: _main+8↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401058</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>总结：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="../../imgs/x86/5.1.png"
    data-srcset="../../imgs/x86/5.1.png, ../../imgs/x86/5.1.png 1.5x, ../../imgs/x86/5.1.png 2x"
    data-sizes="auto"
    alt="if语句"
    title="if语句"/></p>
<h3 id="52-if-else语句">5.2 if else语句</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span> 
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc &gt; 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc == 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc &lt; 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc &lt; 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc == 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;argc &gt; 0&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">test</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401048</span>                 <span class="nf">jle</span>     <span class="no">short</span> <span class="no">loc_40105B</span> <span class="c1">; argc &lt;= 0 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;argc &gt; 0&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">F</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span> <span class="no">loc_40105B</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+8↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_40106E</span> <span class="c1">; argc != 0 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aArgc0_0</span> <span class="c1">; &#34;argc == 0&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401062</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">A</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">D</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span> <span class="no">loc_40106E</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main:loc_40105B↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aArgc0_1</span> <span class="c1">; &#34;argc &lt; 0&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401073</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401078</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">D</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">E</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">E</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="53-switch语句">5.3 switch语句</h3>
<h4 id="531-分支少于4个">5.3.1 分支少于4个</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">100</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 100&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">100</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 100&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">],</span> <span class="mi">1</span>      <span class="c1">; n = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>    <span class="c1">; eax = n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B2</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_4010E4</span> <span class="c1">; eax == 1 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B4</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B7</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_4010D1</span> <span class="c1">; eax == 3 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B9</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">61</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span>                 <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_4010F1</span> <span class="c1">; eax != 100 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BE</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN100</span>    <span class="c1">; &#34;n == 100&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C3</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C8</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CB</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CD</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D0</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D1</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D1</span> <span class="no">loc_4010D1</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+27↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D1</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN3</span>      <span class="c1">; &#34;n == 3&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D6</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DB</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DE</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E0</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E3</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E4</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E4</span> <span class="no">loc_4010E4</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+22↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E4</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN1</span>      <span class="c1">; &#34;n == 1&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E9</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EE</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F1</span> <span class="no">loc_4010F1</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+2C↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F1</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F3</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F6</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F6</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="532-分支大于4个且值连续">5.3.2 分支大于4个且值连续</h4>
<p>会对case语句块制作地址表，以减少比较跳转次数</p>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 5&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 6&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 7&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 5&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 6&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 7&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">goto</span> <span class="n">LABEL_8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">],</span> <span class="mi">1</span>      <span class="c1">; n = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">dec</span>     <span class="no">eax</span>             <span class="c1">; exa -= 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B0</span>                 <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">6</span>          <span class="c1">; switch 7 cases
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B3</span>                 <span class="no">ja</span>      <span class="no">short</span> <span class="no">default_case</span> <span class="c1">; jumptable 004010B5 default case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B5</span>                 <span class="no">jmp</span>     <span class="no">ds</span><span class="p">:</span><span class="no">off_401130</span><span class="p">[</span><span class="no">eax</span><span class="p">*</span><span class="mi">4</span><span class="p">]</span> <span class="c1">; switch jump
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span> <span class="no">case_1</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BC</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN1</span>      <span class="c1">; jumptable 004010B5 case 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C1</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C6</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C9</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CB</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CD</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CE</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span> <span class="no">case_2</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN2</span>      <span class="c1">; jumptable 004010B5 case 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D4</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D9</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DC</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DE</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E0</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E1</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span> <span class="no">case_3</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN3</span>      <span class="c1">; jumptable 004010B5 case 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E7</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EC</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EF</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F1</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F3</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F4</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span> <span class="no">case_5</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN5</span>      <span class="c1">; jumptable 004010B5 case 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FA</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401102</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401104</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401106</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401107</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401108</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401108</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401108</span> <span class="nl">case_6:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401108</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401108</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aN6</span>      <span class="c1">; jumptable 004010B5 case 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">D</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401112</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401115</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401117</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401119</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">A</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span> <span class="no">case_7</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span>                                         <span class="c1">; DATA XREF: _main:off_401130↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN7</span>      <span class="c1">; jumptable 004010B5 case 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401120</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401125</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401128</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401128</span> <span class="nl">default_case:</span>                           <span class="c1">; CODE XREF: _main+23↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401128</span>                                         <span class="c1">; _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401128</span>                                         <span class="c1">; DATA XREF: ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401128</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; jumptable 004010B5 default case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">D</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">D</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">E</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>               <span class="c1">; 将当前位置调整为16字节对齐
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401130</span> <span class="nf">off_401130</span>      <span class="no">dd</span> <span class="no">offset</span> <span class="no">case_1</span>        <span class="c1">; DATA XREF: _main+25↑r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_2</span>        <span class="c1">; jump table for switch statement
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">default_case</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401130</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_7</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401130</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="533-分支大于4个值不连续且最大case值和case值的差小于256">5.3.3 分支大于4个，值不连续，且最大case值和case值的差小于256</h4>
<p>有两张表</p>
<ul>
<li>case语句块地址表：每一项保存一个case语句块的首地址，有几个case就有几项，default也在里面。</li>
<li>case语句块索引表：保存地址表的编号，索引表的大小等于最大case值和最小case值的差。</li>
</ul>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span> 
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 5&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 6&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">255</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 255&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 5&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 6&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">255</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 255&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">goto</span> <span class="n">LABEL_8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">],</span> <span class="mi">1</span>      <span class="c1">; n = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">dec</span>     <span class="no">eax</span>             <span class="c1">; exa -= 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B0</span>                 <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">FEh</span>       <span class="c1">; switch 255 cases
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B5</span>                 <span class="no">ja</span>      <span class="no">short</span> <span class="no">default_case</span> <span class="c1">; n &gt; 255 直接跳转到 default
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B7</span>                 <span class="no">movzx</span>   <span class="no">eax</span><span class="p">,</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="no">ds</span><span class="p">:</span><span class="no">Index_table</span><span class="p">[</span><span class="no">eax</span><span class="p">]</span> <span class="c1">; 将源操作数中的数据复制到目标操作数中，并将目标操作数的高位清零
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BE</span>                 <span class="no">jmp</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="no">ds</span><span class="p">:</span><span class="no">Address_table</span><span class="p">[</span><span class="no">eax</span><span class="p">*</span><span class="mi">4</span><span class="p">]</span> <span class="c1">; switch jump
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span> <span class="no">case_1</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN1</span>      <span class="c1">; jumptable 004010BE case 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CA</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D2</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D4</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D6</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D7</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span> <span class="no">case_2</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN2</span>      <span class="c1">; jumptable 004010BE case 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DD</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E5</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E7</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E9</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EA</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span> <span class="no">case_3</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN3</span>      <span class="c1">; jumptable 004010BE case 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F0</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F8</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FA</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FC</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FD</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span> <span class="no">case_5</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN5</span>      <span class="c1">; jumptable 004010BE case 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401103</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401108</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401110</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401111</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401111</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401111</span> <span class="nl">case_6:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401111</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401111</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aN6</span>      <span class="c1">; jumptable 004010BE case 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401116</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">E</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401120</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401122</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401123</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401124</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401124</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401124</span> <span class="nl">case_255:</span>                               <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401124</span>                                         <span class="c1">; DATA XREF: _main:Address_table↓o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401124</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aN255</span>    <span class="c1">; jumptable 004010BE case 254
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401129</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">E</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401131</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401131</span> <span class="nl">default_case:</span>                           <span class="c1">; CODE XREF: _main+25↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401131</span>                                         <span class="c1">; _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401131</span>                                         <span class="c1">; DATA XREF: ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401131</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; jumptable 004010BE default case
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401133</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401135</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401136</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401136</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401137</span>                 <span class="nf">align</span> <span class="mi">4</span>                 <span class="c1">; 将当前位置调整为4字节对齐
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401138</span> <span class="nl">Address_table:</span>                          <span class="c1">; DATA XREF: _main+2E↑r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401138</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">case_2</span><span class="p">,</span> <span class="no">offset</span> <span class="no">case_3</span><span class="p">,</span> <span class="no">offset</span> <span class="no">case_5</span> <span class="c1">; jump table for switch statement
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401138</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">case_6</span><span class="p">,</span> <span class="no">offset</span> <span class="no">case_255</span><span class="p">,</span> <span class="no">offset</span> <span class="no">default_case</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span> <span class="nl">Index_table:</span>                            <span class="c1">; DATA XREF: _main+27↑r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span> <span class="c1">; indirect table for switch statement
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401154</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="534-分支大于4个值不连续且最大case值和case值的差大于256">5.3.4 分支大于4个，值不连续，且最大case值和case值的差大于256</h4>
<p>将每个case值作为一个节点，找到这些节点的中间值作为跟节点，形成一颗平衡二叉树，以每个节点作为判定值，大于和小于关系分别对应左子树和右子树。</p>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 8</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 10</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">35</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 35</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">37</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 37</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="mi">666</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 666</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;default</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">10</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 10</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 2</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 3</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 8</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">goto</span> <span class="k">default</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">35</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 35</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">37</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 37</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="mi">666</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;n == 666</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">printf</span><span class="p">(</span><span class="s">&#34;default</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">],</span> <span class="mi">0</span>      <span class="c1">; n = 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>    <span class="c1">; exa = n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AF</span>                 <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B2</span>                 <span class="no">jg</span>      <span class="no">short</span> <span class="no">select_subcase</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B4</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">case_10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B6</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B9</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">case_2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BB</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BE</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">case_3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C0</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C3</span>                 <span class="no">jnz</span>     <span class="no">short</span> <span class="no">default</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN8</span>      <span class="c1">; &#34;n == 8\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CA</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">CF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D2</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D4</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D6</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D7</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span> <span class="no">case_3</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+2E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">D8</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN3</span>      <span class="c1">; &#34;n == 3\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">DD</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E2</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E5</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E7</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">E9</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EA</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span> <span class="no">case_2</span><span class="p">:</span>                                 <span class="c1">; CODE XREF: _main+29↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN2</span>      <span class="c1">; &#34;n == 2\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F0</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F5</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">F8</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FA</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FC</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FD</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span> <span class="no">case_10</span><span class="p">:</span>                                <span class="c1">; CODE XREF: _main+24↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">FE</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN10</span>     <span class="c1">; &#34;n == 10\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401103</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401108</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040110</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401110</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401111</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401111</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401111</span> <span class="nl">select_subcase:</span>                         <span class="c1">; CODE XREF: _main+22↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401111</span>                 <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">23</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401114</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">case_35</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401116</span>                 <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401119</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">case_37</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040111</span><span class="nf">B</span>                 <span class="no">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">275</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401120</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">case_666</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401122</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401122</span> <span class="nl">default:</span>                                <span class="c1">; CODE XREF: _main+33↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401122</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aDefault</span> <span class="c1">; &#34;default\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401127</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">C</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040112</span><span class="nf">F</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401131</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401133</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401134</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401135</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401135</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401135</span> <span class="nl">case_666:</span>                               <span class="c1">; CODE XREF: _main+90↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401135</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aN666</span>    <span class="c1">; &#34;n == 666\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040113</span><span class="nf">A</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040113</span><span class="nf">F</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401142</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401144</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401146</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401147</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401148</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401148</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401148</span> <span class="nl">case_37:</span>                                <span class="c1">; CODE XREF: _main+89↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401148</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aN37</span>     <span class="c1">; &#34;n == 37\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040114</span><span class="nf">D</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401152</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401155</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401157</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401159</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040115</span><span class="nf">A</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040115</span><span class="nf">B</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040115</span><span class="nf">B</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040115</span><span class="nf">B</span> <span class="no">case_35</span><span class="p">:</span>                                <span class="c1">; CODE XREF: _main+84↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040115</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aN35</span>     <span class="c1">; &#34;n == 35\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401160</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401165</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401168</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040116</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040116</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040116</span><span class="nf">D</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040116</span><span class="nf">D</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="54-do-while语句">5.4 do while语句</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">do</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">sum</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="n">v4</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">&lt;=</span> <span class="n">argc</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401001</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401003</span>                 <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argc</span><span class="p">]</span> <span class="c1">; edx = argc
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401006</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; eax = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401008</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ecx</span>        <span class="c1">; ecx = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040100</span><span class="nf">A</span>                 <span class="no">nop</span>     <span class="no">word</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="no">eax</span><span class="err">+</span><span class="mi">00</span><span class="no">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401010</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401010</span> <span class="nl">loc_401010:</span>                             <span class="c1">; CODE XREF: _main+15↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401010</span>                 <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ecx</span>        <span class="c1">; sum += i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401012</span>                 <span class="nf">inc</span>     <span class="no">ecx</span>             <span class="c1">; i++
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401013</span>                 <span class="nf">cmp</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401015</span>                 <span class="nf">jle</span>     <span class="no">short</span> <span class="no">loc_401010</span> <span class="c1">; i &lt;= argc 则跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401017</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401018</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401018</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="55-while语句">5.5 while语句</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">+=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">+=</span> <span class="n">v6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;=</span> <span class="mi">99</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;=</span> <span class="mi">100</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">+</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">xor</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401045</span>                 <span class="nf">xor</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401049</span>                 <span class="nf">nop</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">00000000</span><span class="no">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span> <span class="nl">loc_401050:</span>                             <span class="c1">; CODE XREF: _main+1B↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">inc</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401051</span>                 <span class="nf">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401053</span>                 <span class="nf">add</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">2</span>          <span class="c1">; 步长为2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401058</span>                 <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">63</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">jle</span>     <span class="no">short</span> <span class="no">loc_401050</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">64</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>                 <span class="nf">cmovle</span>  <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; if(eax &lt;= 64h) esi = eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401063</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">edx</span><span class="err">+</span><span class="no">ecx</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401066</span>                 <span class="nf">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401068</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401069</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\r\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401073</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401076</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401078</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401079</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401079</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="56-for语句">5.6 for语句</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1">//内部会优化，把步长改为4，减少循环次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// edi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">+=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">+=</span> <span class="n">v6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">+=</span> <span class="n">v6</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">+=</span> <span class="n">v6</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;=</span> <span class="mi">100</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v7</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">+</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401042</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401044</span>                 <span class="nf">xor</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">xor</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401048</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">D</span>                 <span class="no">xor</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">F</span>                 <span class="no">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span> <span class="nl">loc_401050:</span>                             <span class="c1">; CODE XREF: _main+25↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">inc</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401051</span>                 <span class="nf">add</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401054</span>                 <span class="nf">add</span>     <span class="no">edx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span>                 <span class="nf">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">add</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">add</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">F</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 步长为4，减少循环次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401062</span>                 <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">64</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401065</span>                 <span class="nf">jle</span>     <span class="no">short</span> <span class="no">loc_401050</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">edx</span><span class="err">+</span><span class="no">esi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">A</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">C</span>                 <span class="no">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\r\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401074</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401079</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">C</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">E</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401080</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401080</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="6-函数的工作原理">6. 函数的工作原理</h2>
<h3 id="61-栈帧的形成和关闭">6.1 栈帧的形成和关闭</h3>
<p>栈在内存中是一块特殊的存储空间，它的存储原则是“先进后出”，即最先被存储的数据最后被释放。汇编过程通常使用PUSH指令与POP指令对栈空间执行数据压入和数据弹出的操作。</p>
<p><strong>栈结构在内存中占用一段连续的存储空间，通过esp和ebp这两个栈指针寄存器保存当前栈的起始地址与结束地址（又称为栈顶与栈底）。在32位程序的栈结构中，每4字节的栈空间保存一个数据；在64位程序的栈结构中，每8字节的栈空间保存一个数据。像这样的栈顶到栈底之间的存储空间被称为栈帧</strong>。</p>
<p>栈帧是如何形成的呢？当栈顶指针esp小于栈底指针ebp时，就形成了栈帧。通常，在C++中，栈帧可以寻址局部变量、函数返回地址、函数参数等数据。</p>
<p>不同的两次函数调用，形成的栈帧也不相同。当一个函数调用另一个函数时，就会针对调用的函数开辟所需的栈空间，形成此函数的栈帧。当这个函数结束调用时，需要清除它使用的栈空间，关闭栈帧，我们把这一过程称为栈平衡。</p>
<p>如果某一函数开辟了新的栈空间后没有进行恢复，或者过度恢复，就会造成栈空间上溢或下溢，极有可能给程序带来致命错误。</p>
<h3 id="62-各种调用方式的考察">6.2 各种调用方式的考察</h3>
<p>C++环境下的调用约定有3种：</p>
<ul>
<li>_cdecl：C\C++默认的调用方式，调用方平衡栈，不定参数的函数可以使用这种方式。(外平栈，按从右至左的顺序压参数入栈)</li>
<li>_stdcall：被调方平衡栈，不定参数的函数无法使用这种方式。(内平栈，按从右至左的顺序压参数入栈)</li>
<li>_fastcall：：寄存器方式传参，被调方平衡栈，不定参数的函数无法使用这种方式。(前两个参数用ecx和edx传参，其余参数通过栈传参方式，按从右至左的顺序压参数入栈)</li>
</ul>
<p>当函数参数个数为0时，无须区分调用方式，使用_cdecl和_stdcall都一样。而大部分函数都是有参数的，通过查看平衡栈即可还原对应的调用方式。我们通过代码清单6-1分析_cdecl与_stdcall这两种调用方式的区别。</p>
<h3 id="63-函数的参数">6.3 函数的参数</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addNumber</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">n1</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span> <span class="c1">// 防止变量被常量扩散优化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">addNumber</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">scanf_s</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401093</span>                 <span class="nf">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401094</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">],</span> <span class="mi">0</span>      <span class="c1">; n = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A4</span>                 <span class="no">call</span>    <span class="no">_scanf_s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>    <span class="c1">; exa = n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AC</span>                 <span class="no">inc</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AD</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">AE</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aD_0</span>     <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B3</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">B8</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BB</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BD</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">BF</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C0</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">C0</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="7-变量在内存中的位置和访问方式">7. 变量在内存中的位置和访问方式</h2>
<p>变量的作用域</p>
<ul>
<li>全局变量：属于进程作用域，整个进程都能够访问到</li>
<li>静态变量：属于文件作用域，在当前源码文件内可以访问到</li>
<li>局部变量：属于函数作用域，在函数内可以访问到</li>
</ul>
<h3 id="71-全局变量和局部变量的区别">7.1 全局变量和局部变量的区别</h3>
<p>全局变量和局部变量的区别</p>
<ul>
<li>全局变量：可以在程序中的任何位置使用</li>
<li>局部变量：局限于函数作用域内，若超出作用域，则由栈平衡操作释放局方局部变量的空间</li>
<li>局部变量：通过申请栈空间存放，利用栈指针ebp或esp间接访问，其地址是一个未知可变值</li>
<li>全局变量：与常量类似，通过立即数访问</li>
</ul>
<h3 id="72-局部静态变量的工作方式">7.2 局部静态变量的工作方式</h3>
<p>局部静态变量</p>
<ul>
<li>存放在静态存储区</li>
<li>作用域：所定义的函数</li>
<li>生命周期：持续到程序结束</li>
<li>只初始化一次</li>
</ul>
<p>release版</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span> 
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">showStatic</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="kt">int</span> <span class="n">g_static</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>    <span class="c1">//定义局部静态变量，赋值为参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">g_static</span><span class="p">);</span>    <span class="c1">//显示静态变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">showStatic</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>        <span class="c1">//循环调用显示局部静态变量的函数，每次传入不同值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// edi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">__readfsdword</span><span class="p">(</span><span class="mh">0x2Cu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">pOnce</span> <span class="o">&gt;</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">_Init_thread_header</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pOnce</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">pOnce</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dword_4033B0</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">_Init_thread_footer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pOnce</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">dword_4033B0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">++</span><span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">2</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401047</span>                 <span class="nf">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401048</span>                 <span class="nf">xor</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>        <span class="c1">; i = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">C</span>                 <span class="no">nop</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">00</span><span class="no">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span> <span class="nl">loc_401050:</span>                             <span class="c1">; CODE XREF: _main+5D↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">pOnce</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">cmp</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">edi</span><span class="err">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">B</span>                 <span class="no">jle</span>     <span class="no">short</span> <span class="no">loc_401086</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">pOnce</span>    <span class="c1">; pOnce
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401062</span>                 <span class="nf">call</span>    <span class="no">__Init_thread_header</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">A</span>                 <span class="no">cmp</span>     <span class="no">pOnce</span><span class="p">,</span> <span class="mi">0</span><span class="no">FFFFFFFFh</span> <span class="c1">; 检查局部变量是否初始化的标志
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401071</span>                 <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_401086</span> <span class="c1">; 如果不等于0FFFFFFFFh，表示局部静态变量已初始化，跳转到输出
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401073</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">pOnce</span>    <span class="c1">; pOnce
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401078</span>                 <span class="nf">mov</span>     <span class="no">g_static</span><span class="p">,</span> <span class="no">esi</span>   <span class="c1">; g_static = i;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">E</span>                 <span class="no">call</span>    <span class="no">__Init_thread_footer</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401083</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401086</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401086</span> <span class="nl">loc_401086:</span>                             <span class="c1">; CODE XREF: _main+1B↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401086</span>                                         <span class="c1">; _main+31↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401086</span>                 <span class="nf">push</span>    <span class="no">g_static</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401096</span>                 <span class="nf">inc</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">A</span>                 <span class="no">cmp</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">D</span>                 <span class="no">jl</span>      <span class="no">short</span> <span class="no">loc_401050</span> <span class="c1">; i &lt; 5 跳转
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040109</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A0</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A2</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A3</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004010</span><span class="nf">A3</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="73-堆变量">7.3 堆变量</h3>
<ul>
<li>使用malloc和new申请堆空间，返回的数据是申请的堆空间地址</li>
<li>使用free和delete释放堆空间</li>
</ul>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span><span class="o">*</span> <span class="n">buffer1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>    <span class="c1">// 申请堆空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">char</span><span class="o">*</span> <span class="n">buffer2</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>    <span class="c1">// 申请堆空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">buffer2</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">delete</span><span class="p">[]</span> <span class="n">buffer2</span><span class="p">;</span>    <span class="c1">// 释放堆空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">buffer2</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">buffer1</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">free</span><span class="p">(</span><span class="n">buffer1</span><span class="p">);</span>        <span class="c1">// 释放堆空间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">buffer1</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="o">*</span><span class="n">v4</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="n">_malloc</span><span class="p">(</span><span class="mh">0xAu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="k">operator</span> <span class="k">new</span><span class="p">[](</span><span class="mh">0xAu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">operator</span> <span class="k">delete</span><span class="p">[](</span><span class="n">v4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">_free</span><span class="p">(</span><span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401001</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">Ah</span>             <span class="c1">; Size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401003</span>                 <span class="nf">call</span>    <span class="no">ds</span><span class="p">:</span><span class="no">__imp__malloc</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401009</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">Ah</span>             <span class="c1">; size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040100</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040100</span><span class="nf">D</span>                 <span class="no">call</span>    <span class="err">??</span><span class="no">_U@YAPAXI@Z</span>   <span class="c1">; operator new[](uint)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401012</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401015</span>                 <span class="nf">test</span>    <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401017</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_401022</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401019</span>                 <span class="nf">push</span>    <span class="no">eax</span>             <span class="c1">; block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040101</span><span class="nf">A</span>                 <span class="no">call</span>    <span class="err">??</span><span class="no">_V@YAXPAX@Z</span>   <span class="c1">; operator delete[](void *)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040101</span><span class="nf">F</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401022</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401022</span> <span class="nl">loc_401022:</span>                             <span class="c1">; CODE XREF: _main+17↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401022</span>                 <span class="nf">test</span>    <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401024</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_401030</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401026</span>                 <span class="nf">push</span>    <span class="no">esi</span>             <span class="c1">; Memory
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401027</span>                 <span class="nf">call</span>    <span class="no">ds</span><span class="p">:</span><span class="no">__imp__free</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040102</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401030</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401030</span> <span class="nl">loc_401030:</span>                             <span class="c1">; CODE XREF: _main+24↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401030</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401032</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401033</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401033</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="8-数组和指针的寻址">8. 数组和指针的寻址</h2>
<h3 id="81-数组在函数内">8.1 数组在函数内</h3>
<p>在函数内定义数组</p>
<ul>
<li>去其它声明，该数组即为局部变量，拥有局部变量的所有特性</li>
<li>数组名称表示该数组的首地址</li>
<li>占用的内存空间大小为：sizeof(数据类型)x数组中元素个数</li>
<li>数组的各元素应为同一数据类型，以此可以区分局部变量与数组</li>
</ul>
<p>字符数组初始化为字符串</p>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">s</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;Hello World!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span> <span class="c1">// [esp+0h] [ebp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">s</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x21646C72</span><span class="p">;</span>                <span class="c1">// rld!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">s</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                                    <span class="c1">// &#39;\0&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">s</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;Hello World!&#34;</span><span class="p">;</span>     <span class="c1">// Hello Wo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">s</span>               <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="no">ds</span><span class="p">:</span><span class="no">aHelloWorld</span><span class="err">+</span><span class="mi">8</span> <span class="c1">; eax = &#34;rld!&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401055</span>                 <span class="nf">movq</span>    <span class="no">xmm0</span><span class="p">,</span> <span class="no">qword</span> <span class="no">ptr</span> <span class="no">ds</span><span class="p">:</span><span class="no">aHelloWorld</span> <span class="c1">; xmm0 = &#34;Hello Wo&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">s</span><span class="err">+</span><span class="mi">8</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>                 <span class="nf">mov</span>     <span class="no">al</span><span class="p">,</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="no">ds</span><span class="p">:</span><span class="no">aHelloWorld</span><span class="err">+</span><span class="mi">0</span><span class="no">Ch</span> <span class="c1">; al = &#39;\0&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401065</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">s</span><span class="err">+</span><span class="mi">0</span><span class="no">Ch</span><span class="p">],</span> <span class="no">al</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401068</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">s</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%s&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401071</span>                 <span class="nf">movq</span>    <span class="no">qword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">s</span><span class="p">],</span> <span class="no">xmm0</span> <span class="c1">; s = &#34;Hello Wo&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401076</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">E</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401081</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401083</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401085</span>                 <span class="nf">call</span>    <span class="err">@</span><span class="no">__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">D</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">D</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="82-数组作为参数">8.2 数组作为参数</h3>
<h4 id="821-strlen函数">8.2.1 strlen()函数</h4>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">argv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">strlen</span><span class="p">(</span><span class="o">*</span><span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401000</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401001</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401003</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argv</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401006</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>      <span class="c1">; eax = 字符串首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401008</span>                 <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">1</span><span class="p">]</span>    <span class="c1">; edx = 字符串首地址的下一位置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040100</span><span class="nf">B</span>                 <span class="no">nop</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="no">eax</span><span class="err">+</span><span class="mi">00</span><span class="no">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401010</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401010</span> <span class="nl">loc_401010:</span>                             <span class="c1">; CODE XREF: _main+15↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401010</span>                 <span class="nf">mov</span>     <span class="no">cl</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>       <span class="c1">; 获取字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401012</span>                 <span class="nf">inc</span>     <span class="no">eax</span>             <span class="c1">; 偏移量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401013</span>                 <span class="nf">test</span>    <span class="no">cl</span><span class="p">,</span> <span class="no">cl</span>          <span class="c1">; 检测空字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401015</span>                 <span class="nf">jnz</span>     <span class="no">short</span> <span class="no">loc_401010</span> <span class="c1">; 获取字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401017</span>                 <span class="nf">sub</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">edx</span>        <span class="c1">; 字符串结束地址(空字符的位置) - 字符串起始地址 + 1 = 字符串长度(不包含空字符)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401019</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040101</span><span class="nf">A</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040101</span><span class="nf">A</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="822-strcpy函数">8.2.2 strcpy()函数</h4>
<p>在字符串初始化时，利用xmm寄存器初始化数组的值，一次可以初始化16字节，效率更高。</p>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span> <span class="c1">//字符数组定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//字符串复制
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// cl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span> <span class="c1">// [esp+0h] [ebp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="n">argv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">buffer</span> <span class="o">-</span> <span class="o">*</span><span class="n">argv</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">buffer</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="n">v3</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span><span class="p">[</span><span class="n">v4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v5</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">buffer</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">18</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">18</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">argv</span><span class="p">]</span> <span class="c1">; eax = argv
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401053</span>                 <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="p">]</span> <span class="c1">; edx = buffer
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401056</span>                 <span class="nf">xorps</span>   <span class="no">xmm0</span><span class="p">,</span> <span class="no">xmm0</span>      <span class="c1">; xmm0 = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401059</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; buffer[0] = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">D</span>                 <span class="no">movups</span>  <span class="no">xmmword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="err">+</span><span class="mi">1</span><span class="p">],</span> <span class="no">xmm0</span> <span class="c1">; buffer[1 ~ 16] 设置为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401061</span>                 <span class="nf">mov</span>     <span class="no">word</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="err">+</span><span class="mi">11</span><span class="no">h</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; buffer[17 ~ 18] 设置为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>      <span class="c1">; eax = argv[0]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401069</span>                 <span class="nf">sub</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; edx = buffer - *argc  两个地址的差
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="err">+</span><span class="mi">13</span><span class="no">h</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; buffer[19] = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">F</span>                 <span class="no">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401070</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401070</span> <span class="nl">loc_401070:</span>                             <span class="c1">; CODE XREF: _main+3B↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401070</span>                 <span class="nf">mov</span>     <span class="no">cl</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>       <span class="c1">; *ptr_char
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401072</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">1</span><span class="p">]</span>    <span class="c1">; 通过字符指针(ptr_char)来进行偏移
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401075</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">edx</span><span class="err">+</span><span class="no">eax-1</span><span class="p">],</span> <span class="no">cl</span> <span class="c1">; 复制字符，通过argv[0]的地址差值算出buffer的地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401079</span>                 <span class="nf">test</span>    <span class="no">cl</span><span class="p">,</span> <span class="no">cl</span>          <span class="c1">; 空字符结束循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">B</span>                 <span class="no">jnz</span>     <span class="no">short</span> <span class="no">loc_401070</span> <span class="c1">; *ptr_char
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">buffer</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401080</span>                 <span class="nf">push</span>    <span class="no">eax</span>             <span class="c1">; _Format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401081</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401086</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401089</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">C</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">E</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401090</span>                 <span class="nf">call</span>    <span class="err">@</span><span class="no">__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401095</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401097</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401098</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401098</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="83-存放指针类型数组的数组">8.3 存放指针类型数组的数组</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ary</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#34;Hello &#34;</span><span class="p">,</span> <span class="s">&#34;World &#34;</span><span class="p">,</span> <span class="s">&#34;!</span><span class="se">\n</span><span class="s">&#34;</span> <span class="p">};</span><span class="c1">//字符串指针数组定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="n">ary</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="c1">//显示输出字符串数组中的各项
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ary</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// [esp+4h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">ary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;Hello &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">ary</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;World &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">ary</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="n">ary</span><span class="p">[</span><span class="n">v3</span><span class="o">++</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">ary</span>             <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">envp</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401051</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ary</span><span class="p">],</span> <span class="no">offset</span> <span class="no">aHello</span> <span class="c1">; &#34;Hello &#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401058</span>                 <span class="nf">xor</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esi</span>        <span class="c1">; esi = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ary</span><span class="err">+</span><span class="mi">4</span><span class="p">],</span> <span class="no">offset</span> <span class="no">aWorld</span> <span class="c1">; &#34;World &#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401061</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ary</span><span class="err">+</span><span class="mi">8</span><span class="p">],</span> <span class="no">offset</span> <span class="no">asc_402108</span> <span class="c1">; &#34;!\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401068</span>                 <span class="nf">nop</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="no">eax</span><span class="err">+</span><span class="mi">00000000</span><span class="no">h</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401070</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401070</span> <span class="nl">loc_401070:</span>                             <span class="c1">; CODE XREF: _main+40↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401070</span>                 <span class="nf">push</span>    <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">esi</span><span class="p">*</span><span class="mi">4</span><span class="err">+</span><span class="no">ary</span><span class="p">]</span> <span class="c1">; _Format
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401074</span>                 <span class="nf">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401079</span>                 <span class="nf">inc</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">A</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040107</span><span class="nf">D</span>                 <span class="no">cmp</span>     <span class="no">esi</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401080</span>                 <span class="nf">jl</span>      <span class="no">short</span> <span class="no">loc_401070</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401082</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401085</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401087</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401089</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">A</span>                 <span class="no">call</span>    <span class="err">@</span><span class="no">__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040108</span><span class="nf">F</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401091</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401092</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401092</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="84-函数指针">8.4 函数指针</h3>
<p>release</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">_stdcall</span> <span class="nf">show</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;show : %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span><span class="p">(</span><span class="n">_stdcall</span> <span class="o">*</span> <span class="n">pfn</span><span class="p">)(</span><span class="kt">int</span><span class="p">)</span> <span class="o">=</span> <span class="n">show</span><span class="p">;</span> <span class="c1">//函数指针定义并初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">pfn</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">//使用函数指针调用函数并获取返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;ret = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="n">show</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">printf</span><span class="p">(</span><span class="s">&#34;ret = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="c1">; int __stdcall show(int n)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span> <span class="err">?</span><span class="nf">show@@YGHH@Z</span>   <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main+2↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span> <span class="nf">n</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401040</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401041</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401043</span>                 <span class="nf">push</span>    <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401046</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;show : %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040104</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401050</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401053</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401056</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span>                 <span class="nf">retn</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span> <span class="err">?</span><span class="nf">show@@YGHH@Z</span>   <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401057</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040105</span><span class="nf">A</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401060</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span> <span class="c1">; int __cdecl main(int argc, const char **argv, const char **envp)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401060</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: __scrt_common_main_seh+F4↓p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401060</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401060</span>                 <span class="nf">push</span>    <span class="mi">5</span>               <span class="c1">; n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401062</span>                 <span class="nf">call</span>    <span class="err">?</span><span class="no">show@@YGHH@Z</span>   <span class="c1">; show(int)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00401067</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401068</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aRetD</span>    <span class="c1">; &#34;ret = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0040106</span><span class="nf">D</span>                 <span class="no">call</span>    <span class="no">_printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401072</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401075</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401077</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00401077</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="9-结构体和类">9. 结构体和类</h2>
<h3 id="91-对象的内存布局">9.1 对象的内存布局</h3>
<ol>
<li>空类</li>
</ol>
<p>空类的长度位1字节</p>
<ol start="2">
<li>内存对齐</li>
</ol>
<p>结构体中的数据成员类型最大值为M，指定对齐值为N，则实际对齐值为q=min(M,N)</p>
<ol start="3">
<li>静态数据成员</li>
</ol>
<p>类中的数据成员被修饰为静态时，它与局部静态变量类似，存放的位置和全局变量一致</p>
<h3 id="92-this指针">9.2 this指针</h3>
<p>对象调用成员的方法以及取出数据成员的过程</p>
<ul>
<li>利用寄存器ecx保存对象的首地址</li>
<li>以寄存器传参的方式将其传递到成员函数中</li>
</ul>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="n">setAge</span><span class="p">(</span><span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//公有成员函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span> <span class="c1">//公有数据成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">setAge</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">//调用成员函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Person : %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">);</span> <span class="c1">//获取数据成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">setAge</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">setAge</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;Person : %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_D0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">34</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BE</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C3</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C8</span>                 <span class="no">push</span>    <span class="mi">5</span>               <span class="c1">; age
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CA</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CD</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">setAge@Person@@QAEXH@Z</span> <span class="c1">; Person::setAge(int)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D2</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D5</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D6</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;Person : %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DB</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E3</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E5</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E6</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E8</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E9</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E9</span> <span class="no">loc_4118E9</span><span class="p">:</span>                             <span class="c1">; DATA XREF: .text:off_41111D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E9</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EF</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F4</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F5</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F6</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F7</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F8</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F9</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FC</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FE</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411903</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411909</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411910</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411912</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411913</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411913</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411914</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411914</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_41191C</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411914</span>                                         <span class="c1">; DATA XREF: _main:loc_4118E9↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">C</span> <span class="no">dword_41191C</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">4</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411924</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411928</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+84↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411928</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411928</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">F</span>                 <span class="no">align</span> <span class="mi">80</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; void __thiscall Person::setAge(Person *this, int age)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span> <span class="err">?</span><span class="nf">setAge@Person@@QAEXH@Z</span> <span class="no">proc</span> <span class="no">near</span>       <span class="c1">; CODE XREF: Person::setAge(int)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">var_CC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">age</span>             <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411981</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411983</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411989</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_CC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411993</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411998</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">D</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; ecx保存person对象的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A3</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; eax = this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A6</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">age</span><span class="p">]</span>  <span class="c1">; ecx = age
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A9</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="no">ecx</span>      <span class="c1">; this-&gt;age = age
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AB</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AC</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AD</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AE</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B0</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B1</span>                 <span class="no">retn</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B1</span> <span class="err">?</span><span class="no">setAge@Person@@QAEXH@Z</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="93-对象作为函数参数">9.3 对象作为函数参数</h3>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//参数为类Person的对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;age = %d , height = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">show</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">show</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;age = %d , height = %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">show</span><span class="p">((</span><span class="n">Person</span><span class="p">)</span><span class="mh">0x200000001</span><span class="n">i64</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_D0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">34</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BE</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.height</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CC</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.height</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CF</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D0</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D3</span>                 <span class="no">push</span>    <span class="no">ecx</span>             <span class="c1">; person
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D4</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">show@@YAXVPerson@@@Z</span> <span class="c1">; show(Person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D9</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DC</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DE</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DF</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E1</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E2</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E8</span> <span class="no">loc_4118E8</span><span class="p">:</span>                             <span class="c1">; DATA XREF: .text:off_41111D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E8</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">ED</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EE</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EF</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F0</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F1</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F2</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F8</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FA</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FF</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411901</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411902</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411902</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411903</span>                 <span class="nf">align</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411904</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411904</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_41190C</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411904</span>                                         <span class="c1">; DATA XREF: _main+42↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">C</span> <span class="no">dword_41190C</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">8</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411914</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411918</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+74↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411918</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411918</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">F</span>                 <span class="no">align</span> <span class="mi">80</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; void __cdecl show(Person person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span> <span class="err">?</span><span class="nf">show@@YAXVPerson@@@Z</span> <span class="no">proc</span> <span class="no">near</span>         <span class="c1">; CODE XREF: .text:004113C5↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>                                         <span class="c1">; show(Person)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">var_C0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411981</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411983</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411989</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411992</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">30</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411997</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">E</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.height</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A1</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A5</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A6</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;age = %d , height = %d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AB</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B0</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B3</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B4</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B5</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B6</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BC</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BE</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C3</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C5</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C6</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C6</span> <span class="err">?</span><span class="no">show@@YAXVPerson@@@Z</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>含有数组数据成员的对象传参</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">//定义数组类型的数据成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;age = %d , height = %d name:%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">person</span><span class="p">.</span><span class="n">height</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">strcpy</span><span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#34;tom&#34;</span><span class="p">);</span> <span class="c1">//赋值数据成员数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">show</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">show</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;age = %d , height = %d name:%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">age</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">height</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp-28h] [ebp-128h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-108h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp-4h] [ebp-104h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">person</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">person</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__strcpy</span><span class="p">(</span><span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#34;tom&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">qmemcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="n">show</span><span class="p">(</span><span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="err">00000000</span> <span class="nf">Person</span>          <span class="no">struc</span> <span class="c1">; (sizeof=0x28, align=0x4, copyof_573)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000000</span>                                         <span class="c1">; XREF: ?show@@YAXVPerson@@@Z/r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000000</span>                                         <span class="c1">; _main/r ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000000</span> <span class="nf">age</span>             <span class="no">dd</span> <span class="err">?</span>                    <span class="c1">; XREF: _main+28/w
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000000</span>                                         <span class="c1">; show(Person)+26/r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000004</span> <span class="nf">height</span>          <span class="no">dd</span> <span class="err">?</span>                    <span class="c1">; XREF: _main+2F/w
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000004</span>                                         <span class="c1">; show(Person)+22/r
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000008</span> <span class="nf">name</span>            <span class="no">db</span> <span class="mi">32</span> <span class="no">dup</span><span class="p">(</span><span class="err">?</span><span class="p">)</span>            <span class="c1">; XREF: _main+3B/o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000008</span>                                         <span class="c1">; show(Person)+1E/o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">00000028</span> <span class="nf">Person</span>          <span class="no">ends</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_F4</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">F4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">30</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">F4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">3</span><span class="no">Dh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BE</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C3</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C8</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">],</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CF</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.height</span><span class="p">],</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D6</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">Source</span>   <span class="c1">; &#34;tom&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DB</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.name</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DE</span>                 <span class="no">push</span>    <span class="no">eax</span>             <span class="c1">; Dest
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DF</span>                 <span class="no">call</span>    <span class="no">j__strcpy</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E4</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span> <span class="no">loc_4118E7</span><span class="p">:</span>                             <span class="c1">; DATA XREF: .text:off_41111D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">28</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EA</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span>        <span class="c1">; 设置循环的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EF</span>                 <span class="no">lea</span>     <span class="no">esi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; esi保存person对象的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F2</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">esp</span>        <span class="c1">; 设置edi为当前栈顶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F4</span>                 <span class="no">rep</span> <span class="no">movsd</span>               <span class="c1">; 执行ecx(10)次4字节内存复制，将esi所指向的数据复制到edi指向的存储区域中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F6</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">show@@YAXVPerson@@@Z</span> <span class="c1">; show(Person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FB</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">28</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FE</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411900</span>                 <span class="nf">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411901</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411903</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411904</span>                 <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">A</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411910</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411911</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411912</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411913</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411914</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411917</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411919</span>                 <span class="nf">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">E</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">F4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411924</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411926</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">D</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">E</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">E</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">F</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_411938</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span>                                         <span class="c1">; DATA XREF: _main+64↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411938</span> <span class="nf">dword_411938</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFD0h</span><span class="p">,</span> <span class="mi">28</span><span class="no">h</span>      <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411940</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411944</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+A0↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411944</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411944</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041194</span><span class="nf">B</span>                 <span class="no">align</span> <span class="mi">40</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; void __cdecl show(Person person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span> <span class="err">?</span><span class="nf">show@@YAXVPerson@@@Z</span> <span class="no">proc</span> <span class="no">near</span>         <span class="c1">; CODE XREF: .text:004113C5↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>                                         <span class="c1">; show(Person)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">var_C0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411981</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411983</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411989</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411992</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">30</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411997</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">E</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.name</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A1</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.height</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A5</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A6</span>                 <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.age</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;age = %d , height = %d name:%s\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AF</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B4</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B7</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B8</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B9</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BA</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C0</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C2</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C7</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C9</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CA</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CA</span> <span class="err">?</span><span class="no">show@@YAXVPerson@@@Z</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="94-对象作为返回值">9.4 对象作为返回值</h3>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span> <span class="c1">//定义两个数据成员，该类的大小为44字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Person</span> <span class="nf">getPerson</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span> <span class="o">=</span> <span class="n">getPerson</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d %d %d&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">count</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">Person</span> <span class="o">*</span><span class="kr">__cdecl</span> <span class="nf">getPerson</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-3Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">person</span><span class="p">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">qmemcpy</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">Person</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST08_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-158h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp+44h] [ebp-124h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+138h] [ebp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">qmemcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v4</span><span class="p">,</span> <span class="n">getPerson</span><span class="p">(</span><span class="o">&amp;</span><span class="n">result</span><span class="p">),</span> <span class="mh">0x2Cu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">qmemcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">person</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d %d %d&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">count</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">person</span><span class="p">.</span><span class="n">buffer</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_15C</span>         <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">15</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">result</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">158</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">var_124</span>         <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">124</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">30</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">15</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">AC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_15C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">57</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">B7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">BE</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">result</span><span class="p">]</span> <span class="c1">; 返回的对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C4</span>                 <span class="no">push</span>    <span class="no">eax</span>             <span class="c1">; result
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">C5</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">getPerson@@YA</span><span class="err">?</span><span class="no">AVPerson@@XZ</span> <span class="c1">; getPerson(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CA</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">CD</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Bh</span>        <span class="c1">; 设置循环的次数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D2</span>                 <span class="no">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">eax</span>        <span class="c1">; 返回对象的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">D4</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_124</span><span class="p">]</span> <span class="c1">; 临时对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DA</span>                 <span class="no">rep</span> <span class="no">movsd</span>               <span class="c1">; 每次从返回对象中复制4字节数据到临时对象中，共11次
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">DC</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Bh</span>        <span class="c1">; 再次设置循环次数，临时对象 =》 person对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E1</span>                 <span class="no">lea</span>     <span class="no">esi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_124</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span> <span class="no">loc_4118E7</span><span class="p">:</span>                             <span class="c1">; DATA XREF: .text:off_41111D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E7</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EA</span>                 <span class="no">rep</span> <span class="no">movsd</span>               <span class="c1">; 将临时对象拷贝到person对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EC</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 偏移4字节，buffer在对象的第5字节处
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F1</span>                 <span class="no">imul</span>    <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span><span class="p">,</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F4</span>                 <span class="no">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ecx</span><span class="err">+</span><span class="no">person.buffer</span><span class="p">]</span> <span class="c1">; person.buffer[9]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F8</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 偏移4字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FE</span>                 <span class="no">imul</span>    <span class="no">ecx</span><span class="p">,</span> <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411901</span>                 <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ecx</span><span class="err">+</span><span class="no">person.buffer</span><span class="p">]</span> <span class="c1">; person.buffer[0]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411905</span>                 <span class="nf">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411906</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.count</span><span class="p">]</span> <span class="c1">; person.count
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411909</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d %d %d&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">F</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411914</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411917</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411919</span>                 <span class="nf">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411923</span>                 <span class="nf">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411928</span>                 <span class="nf">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411929</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">A</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">B</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">15</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411933</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411935</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">D</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">D</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">E</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411940</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411940</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_411948</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411940</span>                                         <span class="c1">; DATA XREF: _main+7D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411948</span> <span class="nf">dword_411948</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFD0h</span><span class="p">,</span> <span class="mi">2</span><span class="no">Ch</span>      <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411950</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411954</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+B0↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411954</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411954</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041195</span><span class="nf">B</span>                 <span class="no">align</span> <span class="mi">40</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="c1">; Person *__cdecl getPerson(Person *result)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span> <span class="err">?</span><span class="nf">getPerson@@YA</span><span class="err">?</span><span class="no">AVPerson@@XZ</span> <span class="no">proc</span> <span class="no">near</span>   <span class="c1">; CODE XREF: .text:004113C5↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>                                         <span class="c1">; .text:004113CA↑j ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">var_100</span>         <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">100</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">i</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">3</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">30</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span> <span class="nf">result</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411980</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411981</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411983</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">100</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411989</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_100</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411992</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411997</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">E</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person.count</span><span class="p">],</span> <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">],</span> <span class="mi">0</span>      <span class="c1">; i = 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AC</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_4119B7</span> <span class="c1">; 跳转到for循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AE</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AE</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AE</span> <span class="no">loc_4119AE</span><span class="p">:</span>                             <span class="c1">; CODE XREF: getPerson(void)+4A↓j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AE</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B1</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B4</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B7</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B7</span> <span class="no">loc_4119B7</span><span class="p">:</span>                             <span class="c1">; CODE XREF: getPerson(void)+2C↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B7</span>                 <span class="no">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">],</span> <span class="mi">0</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BB</span>                 <span class="no">jge</span>     <span class="no">short</span> <span class="no">loc_4119CC</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BD</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C0</span>                 <span class="no">add</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; i + 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C3</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C6</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">ecx</span><span class="p">*</span><span class="mi">4</span><span class="err">+</span><span class="no">person.buffer</span><span class="p">],</span> <span class="no">eax</span> <span class="c1">; person.buffer[i] = i + 1;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CA</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_4119AE</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CC</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CC</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CC</span> <span class="no">loc_4119CC</span><span class="p">:</span>                             <span class="c1">; CODE XREF: getPerson(void)+3B↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CC</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">0</span><span class="no">Bh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D1</span>                 <span class="no">lea</span>     <span class="no">esi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; person对象的地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D4</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">result</span><span class="p">]</span> <span class="c1">; 返回对象的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D7</span>                 <span class="no">rep</span> <span class="no">movsd</span>               <span class="c1">; 将person对象拷贝到返回对象中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D9</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">result</span><span class="p">]</span> <span class="c1">; 将返回对象的地址保存到eax中，作为返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DC</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DD</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DF</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E0</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">stru_4119F4</span> <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E6</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EB</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EC</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">ED</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EE</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EF</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F0</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F2</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F3</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F3</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F4</span> <span class="c1">; _RTC_framedesc stru_4119F4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F4</span> <span class="no">stru_4119F4</span>     <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_4119FC</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F4</span>                                         <span class="c1">; DATA XREF: getPerson(void)+60↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">FC</span> <span class="no">dword_4119FC</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFD0h</span><span class="p">,</span> <span class="mi">2</span><span class="no">Ch</span>      <span class="c1">; DATA XREF: getPerson(void):stru_4119F4↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A04</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="no">aPerson_0</span>     <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A08</span> <span class="no">aPerson_0</span>       <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: getPerson(void)+84↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A08</span> <span class="err">?</span><span class="no">getPerson@@YA</span><span class="err">?</span><span class="no">AVPerson@@XZ</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="10-构造函数和析构函数">10. 构造函数和析构函数</h2>
<p>根据生命周期将对象进行分类，分析各类对象构造函数和析构函数的调用时机</p>
<ul>
<li>局部对象</li>
<li>堆对象</li>
<li>参数对象</li>
<li>返回对象</li>
<li>全局对象</li>
<li>静态对象</li>
</ul>
<h3 id="101-构造函数的出现时机">10.1 构造函数的出现时机</h3>
<h4 id="1011-局部对象">10.1.1 局部对象</h4>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//无参构造函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">//类对象定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411690</span> <span class="c1">; void __thiscall Person::Person(Person *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411690</span> <span class="err">??0</span><span class="nf">Person@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>             <span class="c1">; CODE XREF: Person::Person(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411690</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411690</span> <span class="nf">var_CC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411690</span> <span class="nf">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411690</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411690</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411691</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411693</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411699</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041169</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041169</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041169</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041169</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_CC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">A3</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">A8</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">AD</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">AF</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">B0</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 传进来的this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">B3</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">B6</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="mi">14</span><span class="no">h</span> <span class="c1">; 将对象的前4字节设置为20，即this-&gt;age = 20;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">BC</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; 将this指针传入eax中作为返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">BF</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C0</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C1</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C2</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C4</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C5</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C5</span> <span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="no">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C5</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">C6</span>                 <span class="no">align</span> <span class="mi">20</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="c1">; =============== S U B R O U T I N E =======================================
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="c1">; Attributes: bp-based frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">var_D0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">F2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">34</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">F7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">FC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">FE</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411703</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411705</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411708</span>                 <span class="nf">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041170</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411710</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411712</span>                 <span class="nf">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411713</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411715</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411716</span>                 <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041171</span><span class="nf">C</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411721</span>                 <span class="nf">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411722</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411723</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411724</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411725</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411726</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411729</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041172</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411730</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411736</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411738</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041173</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041173</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411740</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411740</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411741</span>                 <span class="nf">align</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411744</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411744</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_41174C</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411744</span>                                         <span class="c1">; DATA XREF: _main+36↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041174</span><span class="nf">C</span> <span class="no">dword_41174C</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">4</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411754</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411758</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+74↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411758</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>总结：局部对象构造函数的必要条件</p>
<ul>
<li>该成员函数是这个对象在作用域内调用的第一个成员函数，根据this指针可以区分每个对象</li>
<li>这个成员函数通过thiscall方式调用</li>
<li>这个函数返回this指针</li>
</ul>
<h4 id="1012-堆对象">10.1.2 堆对象</h4>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//为了突出本节讨论的问题，这里没有检查new运算的返回值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">p</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">age</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_DWORD</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-F4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+18h] [ebp-ECh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">v2</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="o">*</span><span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span> <span class="c1">; void __thiscall Person::Person(Person *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411820</span> <span class="err">??0</span><span class="nf">Person@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>             <span class="c1">; CODE XREF: Person::Person(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411820</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span> <span class="nf">var_CC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span> <span class="nf">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411821</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411823</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411829</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_CC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411833</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411838</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041183</span><span class="nf">D</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041183</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411840</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411843</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411846</span>                 <span class="nf">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041184</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041184</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411850</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411851</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411852</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411854</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411855</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411855</span> <span class="err">??0</span><span class="nf">Person@@QAE@XZ</span> <span class="no">endp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411930</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">var_F4</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">F4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">var_EC</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">ECh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">var_E0</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">E0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">p</span>               <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">var_C</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="c1">; FUNCTION CHUNK AT .text:004162C0 SIZE 00000012 BYTES
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411930</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411930</span> <span class="c1">; __unwind { // __ehhandler$_main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411930</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411931</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411933</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411935</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">__ehhandler$_main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041193</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411940</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411941</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">E8h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411947</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411948</span>                 <span class="nf">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411949</span>                 <span class="nf">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041194</span><span class="nf">A</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411950</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">3</span><span class="no">Ah</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411955</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041195</span><span class="nf">A</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041195</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411961</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411963</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411964</span>                 <span class="nf">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411967</span>                 <span class="nf">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041196</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="mi">4</span>               <span class="c1">; size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041196</span><span class="nf">F</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">2</span><span class="err">@</span><span class="no">YAPAXI@Z</span>  <span class="c1">; operator new(uint)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411974</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411977</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">],</span> <span class="no">eax</span> <span class="c1">; 申请空间的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041197</span><span class="nf">D</span> <span class="c1">;   try {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041197</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411984</span>                 <span class="nf">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">B</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_4119A0</span> <span class="c1">; 只有申请空间的首地址不为0时，才调用Person对象的构造函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411993</span>                 <span class="nf">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411998</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F4</span><span class="p">],</span> <span class="no">eax</span> <span class="c1">; 构造函数返回的this指针，保存到临时变量中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">E</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_4119AA</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span> <span class="no">loc_4119A0</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+5B↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F4</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; 申请空间失败，设置临时对象指向为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AA</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AA</span> <span class="no">loc_4119AA</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+6E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AA</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B0</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_E0</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B0</span> <span class="c1">;   } // starts at 41197D
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B6</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BD</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_E0</span><span class="p">]</span> <span class="c1">; Person* p
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C3</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">p</span><span class="p">],</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C6</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">p</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C9</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="mi">15</span><span class="no">h</span> <span class="c1">; 设置Person对象的前4字节为21，即：this-&gt;age = 21
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CF</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">p</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D4</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DA</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E2</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E4</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E7</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EE</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">EF</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F0</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F1</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F2</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">F4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F8</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">FA</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">FF</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A01</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A02</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A02</span> <span class="c1">; } // starts at 411930
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A02</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>总结：</p>
<ul>
<li>使用new申请堆空间之后，需要调用构造函数来完成对象数据成员的初始化</li>
<li>如果堆空间申请失败，则不调用构造函数</li>
<li>如果new执行成功，返回值是对象的首地址</li>
<li>识别堆对象的构造函数：重点分析new的双分支结构，在判定new成功的分支迅速定位并得到构造函数</li>
</ul>
<h4 id="1013-参数对象">10.1.3 参数对象</h4>
<p>当对象作为函数参数时，会调用赋值构造函数</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">name</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span><span class="c1">//无参构造函数，初始化指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// 注：如果在复制构造函数中直接复制指针值，那么对象内的两个成员指针会指向同一个资源，这属于浅拷贝
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="c1">// this-&gt;name = obj.name;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="c1">// 为实参对象中的指针所指向的堆空间制作一份副本，这就是深拷贝了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span> <span class="c1">// 为便于讲解，这里没有检查指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">strcpy</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">delete</span><span class="p">[]</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span> <span class="c1">// 为便于讲解，这里没有检查指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">strcpy</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show</span><span class="p">(</span><span class="n">Person</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 参数是对象类型，会触发复制构造函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;name:%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="s">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">show</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="n">Person</span> <span class="o">*</span><span class="n">obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// STF0_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">len</span><span class="p">;</span> <span class="c1">// STE4_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">len</span> <span class="o">=</span> <span class="n">j__strlen</span><span class="p">(</span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">[](</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__strcpy</span><span class="p">(</span><span class="n">v2</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">__autoclassinit2</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__memset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">setName</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">len</span><span class="p">;</span> <span class="c1">// [esp+E8h] [ebp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="o">*</span><span class="n">thisa</span><span class="p">;</span> <span class="c1">// [esp+F4h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">len</span> <span class="o">=</span> <span class="n">j__strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">operator</span> <span class="k">delete</span><span class="p">[](</span><span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">[](</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__strcpy</span><span class="p">(</span><span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp-4h] [ebp-ECh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">__autoclassinit2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">setName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="s">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">show</span><span class="p">(</span><span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">var_DC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D20</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D21</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D23</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D29</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D2A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D2B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D2C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_DC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D32</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">37</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D37</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D3C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D3E</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D43</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D45</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D48</span>                 <span class="no">push</span>    <span class="mi">4</span>               <span class="c1">; unsigned int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D4A</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D4D</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">__autoclassinit2@Person@@QAEXI@Z</span> <span class="c1">; 将person对象的变量初始化为默认值或者自定义值，这里设置为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D52</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D55</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D5A</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">name</span>     <span class="c1">; &#34;Hello&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D5F</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D62</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">setName@Person@@QAEXPBD@Z</span> <span class="c1">; Person::setName(char const *)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D67</span>                 <span class="no">push</span>    <span class="no">ecx</span>             <span class="c1">; person
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D68</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">esp</span>        <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D6A</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; 调用show方法，通过传参会调用拷贝构造函数：Person(const Person&amp; obj)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D6D</span>                 <span class="no">push</span>    <span class="no">eax</span>             <span class="c1">; obj
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D6E</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@ABV0@@Z</span> <span class="c1">; Person::Person(Person const &amp;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D73</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">show@@YAXVPerson@@@Z</span> <span class="c1">; show(Person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D78</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D7B</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D7D</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D7E</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D80</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D81</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D87</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D8C</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D8D</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D8E</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D8F</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D90</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D91</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D94</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D96</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">D9B</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DA1</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DA3</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DA8</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAA</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAB</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAB</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAC</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAC</span> <span class="no">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_414DB4</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DAC</span>                                         <span class="c1">; DATA XREF: _main+61↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DB4</span> <span class="no">dword_414DB4</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">4</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DBC</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DC0</span> <span class="no">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+9C↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414</span><span class="nf">DC0</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1014-返回对象">10.1.4 返回对象</h4>
<p>返回对象与参数对象类似，都会使用赋值构造函数。但是，两者使用时机不同</p>
<ul>
<li>当对象为参数时，在进入函数前使用赋值构造函数</li>
<li>返回对象则在函数返回时使用赋值构造函数</li>
</ul>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">name</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span><span class="c1">//无参构造函数，初始化指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">(</span><span class="k">const</span> <span class="n">Person</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// 注：如果在复制构造函数中直接复制指针值，那么对象内的两个成员指针会指向同一个资源，这属于浅拷贝
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="c1">// this-&gt;name = obj.name;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="c1">// 为实参对象中的指针所指向的堆空间制作一份副本，这就是深拷贝了
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span> <span class="c1">// 为便于讲解，这里没有检查指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">strcpy</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">setName</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">delete</span><span class="p">[]</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">len</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)];</span> <span class="c1">// 为便于讲解，这里没有检查指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">strcpy</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Person</span> <span class="nf">getObject</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="s">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">person</span><span class="p">;</span> <span class="c1">//返回类型为对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="n">getObject</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">__autoclassinit2</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">Size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__memset</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="n">Person</span> <span class="o">*</span><span class="n">obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// STF0_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">len</span><span class="p">;</span> <span class="c1">// STE4_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">len</span> <span class="o">=</span> <span class="n">j__strlen</span><span class="p">(</span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">[](</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__strcpy</span><span class="p">(</span><span class="n">v2</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">setName</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">len</span><span class="p">;</span> <span class="c1">// [esp+E8h] [ebp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="o">*</span><span class="n">thisa</span><span class="p">;</span> <span class="c1">// [esp+F4h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">len</span> <span class="o">=</span> <span class="n">j__strlen</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">operator</span> <span class="k">delete</span><span class="p">[](</span><span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">[](</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__strcpy</span><span class="p">(</span><span class="n">thisa</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">getObject</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">__autoclassinit2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">setName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="s">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">__PAIR__</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">__autoclassinit2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">getObject</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">var_D0</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B10</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B11</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B13</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B19</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B22</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">34</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B27</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B2C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B2E</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B33</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B35</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B38</span>                 <span class="no">push</span>    <span class="mi">4</span>               <span class="c1">; unsigned int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B3A</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B3D</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">__autoclassinit2@Person@@QAEXI@Z</span> <span class="c1">; 将person对象的变量初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B42</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B45</span>                 <span class="no">push</span>    <span class="no">eax</span>             <span class="c1">; result
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B46</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">getObject@@YA</span><span class="err">?</span><span class="no">AVPerson@@XZ</span> <span class="c1">; 将person对象作为 getObject方法的返回对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B4B</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B4E</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B50</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B51</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B53</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B54</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">stru_411B80</span> <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B5A</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B5F</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B60</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B61</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B62</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B63</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B64</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B67</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B69</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B6E</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B74</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B76</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B7B</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B7D</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B7E</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B7E</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B7F</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B80</span> <span class="c1">; _RTC_framedesc stru_411B80
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B80</span> <span class="no">stru_411B80</span>     <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_411B88</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B80</span>                                         <span class="c1">; DATA XREF: _main+44↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B88</span> <span class="no">dword_411B88</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">4</span>        <span class="c1">; DATA XREF: _main:stru_411B80↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B90</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="no">aPerson_0</span>     <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B94</span> <span class="no">aPerson_0</span>       <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+80↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B94</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="102-析构对象的出现时机">10.2 析构对象的出现时机</h3>
<h4 id="1021-局部对象">10.2.1 局部对象</h4>
<p>重点考察作用域的结束处，当对象所在作用域结束后，将销毁作用域所有变量的栈空间，此时便是析构函数出现的时机。析构函数同样属于成员函数，因此在调用的过程中也需要传递this指针。</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">age</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">~</span><span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//退出函数后调用析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411970</span>                                         <span class="c1">; .text:00411325↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411970</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">var_DC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">var_D8</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D8h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span> <span class="nf">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411970</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411971</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411973</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411979</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041197</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041197</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041197</span><span class="nf">C</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_DC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411982</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">37</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411987</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041198</span><span class="nf">E</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411993</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411995</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411998</span>                 <span class="nf">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041199</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">A0</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D8</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AA</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">AD</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">1</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::~Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B2</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B8</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">B9</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BB</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">BC</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C2</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C7</span>                 <span class="no">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C8</span>                 <span class="no">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">C9</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CA</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CB</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CC</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">CF</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D1</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">D6</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">DCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DC</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">DE</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E3</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E5</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E6</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E6</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E7</span>                 <span class="no">align</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E8</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E8</span> <span class="no">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_4119F0</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004119</span><span class="nf">E8</span>                                         <span class="c1">; DATA XREF: _main+4C↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F0</span> <span class="no">dword_4119F0</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF4h</span><span class="p">,</span> <span class="mi">4</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">F8</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">FC</span> <span class="no">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+88↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004119</span><span class="nf">FC</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1022-堆对象">10.2.2 堆对象</h4>
<p>用detele释放对象所在的空间，delete的使用便是找到堆对象调用析构的关键点</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">~</span><span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="o">*</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span> <span class="c1">//为了便于讲解，这里没检查指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="o">-&gt;</span><span class="n">age</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">delete</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Person</span> <span class="o">*</span><span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">scalar</span> <span class="n">deleting</span> <span class="n">destructor</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span> <span class="o">*</span><span class="n">thisa</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">a2</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">operator</span> <span class="k">delete</span><span class="p">(</span><span class="n">thisa</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">thisa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-10Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+30h] [ebp-ECh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="mi">4u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v2</span><span class="o">-&gt;</span><span class="n">age</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Person</span><span class="o">::</span><span class="n">scalar</span> <span class="n">deleting</span> <span class="n">destructor</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="mi">1u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span> <span class="c1">; void *__thiscall Person::`scalar deleting destructor&#39;(Person *this, unsigned int)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span> <span class="err">??</span><span class="no">_GPerson@@QAEPAXI@Z</span> <span class="no">proc</span> <span class="no">near</span>         <span class="c1">; CODE XREF: Person::`scalar deleting destructor&#39;(uint)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span> <span class="no">var_CC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span> <span class="no">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span> <span class="no">arg_0</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">E9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">EC</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">ED</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_CC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F3</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">F8</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FD</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004118</span><span class="nf">FF</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411900</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 设置this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411903</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411906</span>                 <span class="nf">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">1</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::~Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">arg_0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041190</span><span class="nf">E</span>                 <span class="no">and</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411911</span>                 <span class="nf">jz</span>      <span class="no">short</span> <span class="no">loc_411921</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411913</span>                 <span class="nf">push</span>    <span class="mi">4</span>               <span class="c1">; __formal
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411915</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; operator delete(this, 4)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411918</span>                 <span class="nf">push</span>    <span class="no">eax</span>             <span class="c1">; block
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411919</span>                 <span class="nf">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">3</span><span class="err">@</span><span class="no">YAXPAXI@Z</span> <span class="c1">; operator delete(void *,uint)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041191</span><span class="nf">E</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411921</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411921</span> <span class="nl">loc_411921:</span>                             <span class="c1">; CODE XREF: Person::`scalar deleting destructor&#39;(uint)+31↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411921</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411924</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411925</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411926</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411927</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">D</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041192</span><span class="nf">F</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411934</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411936</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411937</span>                 <span class="nf">retn</span>    <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411937</span> <span class="err">??</span><span class="nf">_GPerson@@QAEPAXI@Z</span> <span class="no">endp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_10C</span>         <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_104</span>         <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">104</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_F8</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">F8h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_EC</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">ECh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_E0</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">E0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_C</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="c1">; FUNCTION CHUNK AT .text:004163E0 SIZE 00000012 BYTES
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span> <span class="c1">; __unwind { // __ehhandler$_main
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A10</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A11</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A13</span>                 <span class="no">push</span>    <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A15</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">__ehhandler$_main</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A1A</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A20</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A21</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">100</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A27</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A28</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A29</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A2A</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A30</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A35</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A3A</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A3C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A41</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A43</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A44</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A47</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A4D</span>                 <span class="no">push</span>    <span class="mi">4</span>               <span class="c1">; size
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A4F</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">2</span><span class="err">@</span><span class="no">YAPAXI@Z</span>  <span class="c1">; operator new(uint)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A54</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A57</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">],</span> <span class="no">eax</span> <span class="c1">; new[4] person对象的首地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A5D</span> <span class="c1">;   try {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A5D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A64</span>                 <span class="no">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; 判断new方法是否成功返回
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A6B</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_411A80</span> <span class="c1">; 如果new调用失败，设置指向new的临时对象指向0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A6D</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_EC</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A73</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A78</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A7E</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_411A8A</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A80</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A80</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A80</span> <span class="no">loc_411A80</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+5B↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A80</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; 如果new调用失败，设置指向new的临时对象指向0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A8A</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A8A</span> <span class="no">loc_411A8A</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+6E↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A8A</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A90</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_E0</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A90</span> <span class="c1">;   } // starts at 411A5D
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A96</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">A9D</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_E0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AA3</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; Person* person = new Person()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AA6</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AA9</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="mi">15</span><span class="no">h</span> <span class="c1">; person.age = 21
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AAF</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AB2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>      <span class="c1">; person-&gt;age
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AB4</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AB5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">aD</span>       <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">ABA</span>                 <span class="no">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">ABF</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AC2</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AC5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_104</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">ACB</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_104</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AD1</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F8</span><span class="p">],</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AD7</span>                 <span class="no">cmp</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F8</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; if(person != 0)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">ADE</span>                 <span class="no">jz</span>      <span class="no">short</span> <span class="no">loc_411AF5</span> <span class="c1">; 设置指向new返回的临时对象为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AE0</span>                 <span class="no">push</span>    <span class="mi">1</span>               <span class="c1">; unsigned int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AE2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_F8</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AE8</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="no">_GPerson@@QAEPAXI@Z</span> <span class="c1">; Person::`scalar deleting destructor&#39;(uint)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AED</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">],</span> <span class="no">eax</span> <span class="c1">; 设置指向new返回的临时对象为 this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AF3</span>                 <span class="no">jmp</span>     <span class="no">short</span> <span class="no">loc_411AFF</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AF5</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AF5</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AF5</span> <span class="no">loc_411AF5</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+CE↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AF5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_10C</span><span class="p">],</span> <span class="mi">0</span> <span class="c1">; 设置指向new返回的临时对象为0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AFF</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AFF</span> <span class="no">loc_411AFF</span><span class="p">:</span>                             <span class="c1">; CODE XREF: _main+E3↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">AFF</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B01</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B04</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B0B</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B0C</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B0D</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B0E</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B0F</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">10</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B15</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B17</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1C</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1E</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1F</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1F</span> <span class="c1">; } // starts at 411A10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411</span><span class="nf">B1F</span> <span class="no">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="11-虚函数">11. 虚函数</h2>
<p>对于具有虚函数的类而言，构造函数和析构函数的识别过程更加简单。而且，在类中定义虚函数后，如果没有提供</p>
<p>构造函数，编译器会生成默认的构造函数。</p>
<p>对象的多态需要通过虚表和虚指针完成，虚表指针被定义在对象首地址处，因此虚函数必须作为成员函数使用。</p>
<h3 id="111-虚函数的机制">11.1 虚函数的机制</h3>
<p>当类中定义有虚函数，编译器会将给类中所有虚函数的首地址保存在一张地址表，这张表被称为虚函数地址表，简称虚表。同时还会在类中添加一个隐藏数据成员，称为虚表指针，该指针保存虚表的首地址，用于记录和查找虚函数。</p>
<h4 id="1111-默认构造函数初始化虚表指针的过程">11.1.1 默认构造函数初始化虚表指针的过程</h4>
<ul>
<li>没有编写构造函数时，编译器默认提供构造函数，以完成虚表指针的初始化</li>
<li>虚表中虚函数的地址排列顺序：先声明的虚函数的地址会被排列在虚表靠前的位置</li>
<li>第一个被声明的虚函数的地址在虚表的首地址处</li>
</ul>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getAge</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="p">(</span><span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">//int size = sizeof(Person);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">//定义了虚函数后，因为还含有隐藏数据成员虚表指针，所以Person大小为8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">//printf(&#34;%d&#34;,size);   8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">PersonVtbl</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Person</span><span class="o">::</span><span class="err">`</span><span class="n">vftable</span><span class="err">&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="c1">// 虚表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B34</span> <span class="c1">; const Person::`vftable&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B34</span> <span class="err">??</span><span class="no">_7Person@@6B@</span> <span class="no">dd</span> <span class="no">offset</span> <span class="no">j_</span><span class="err">?</span><span class="no">getAge@Person@@UAEHXZ</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B34</span>                                         <span class="c1">; DATA XREF: Person::Person(void)+26↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B34</span>                                         <span class="c1">; Person::getAge(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B38</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="no">j_</span><span class="err">?</span><span class="no">setAge@Person@@UAEXH@Z</span> <span class="c1">; Person::setAge(int)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B3C</span>                 <span class="no">align</span> <span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B40</span>                 <span class="no">dd</span> <span class="no">offset</span> <span class="err">??</span><span class="no">_R4type_info@@6B@</span> <span class="c1">; const type_info::`RTTI Complete Object Locator&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00416</span><span class="nf">B44</span> <span class="c1">; const type_info::`vftable&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="c1">; void __thiscall Person::Person(Person *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>             <span class="c1">; CODE XREF: Person::Person(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">var_CC</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span> <span class="no">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">E9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">EC</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">ED</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_CC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">F3</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">F8</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">FD</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004116</span><span class="nf">FF</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411700</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 设置this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411703</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411706</span>                 <span class="nf">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="no">offset</span> <span class="err">??</span><span class="no">_7Person@@6B@</span> <span class="c1">; 在person对象前4字节设置虚表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041170</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041170</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411710</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411711</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411712</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411714</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411715</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411715</span> <span class="err">??0</span><span class="nf">Person@@QAE@XZ</span> <span class="no">endp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">var_D4</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">C9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">CA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">CB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">CC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D2</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">35</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D7</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DC</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DE</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">E3</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">E5</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">E8</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">EB</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F0</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F2</span>                 <span class="no">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F3</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F5</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F6</span>                 <span class="no">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">FC</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411801</span>                 <span class="nf">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411802</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411803</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411804</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411805</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411806</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411809</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411810</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411816</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411818</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411820</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411821</span>                 <span class="nf">align</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411824</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411824</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_41182C</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411824</span>                                         <span class="c1">; DATA XREF: _main+36↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">C</span> <span class="no">dword_41182C</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF0h</span><span class="p">,</span> <span class="mi">8</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411834</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411838</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+74↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411838</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1112-调用自身类的虚函数">11.1.2 调用自身类的虚函数</h4>
<p>直接通过对象调用自身的成员虚函数，编译器使用了直接调用函数方式，没有访问虚表指针，而是间接获取虚函数地址。</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getAge</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="p">(</span><span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">setAge</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">getAge</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">setAge</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="n">Person</span><span class="o">::</span><span class="n">getAge</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="c1">; int __cdecl main(int argc, char **argv)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">_main</span>           <span class="no">proc</span> <span class="no">near</span>               <span class="c1">; CODE XREF: _main_0↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">var_D4</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">person</span>          <span class="err">=</span> <span class="no">Person</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">10</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">argc</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span> <span class="no">argv</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">F9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">FA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">FB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004141</span><span class="nf">FC</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_D4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414202</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">35</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414207</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041420</span><span class="nf">C</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041420</span><span class="nf">E</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414213</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414215</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414218</span>                 <span class="nf">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041421</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Person@@QAE@XZ</span> <span class="c1">; Person::Person(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414220</span>                 <span class="nf">push</span>    <span class="mi">14</span><span class="no">h</span>             <span class="c1">; age
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414222</span>                 <span class="nf">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414225</span>                 <span class="nf">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">setAge@Person@@UAEXH@Z</span> <span class="c1">; Person::setAge(int)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041422</span><span class="nf">A</span>                 <span class="no">lea</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041422</span><span class="nf">D</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">?</span><span class="no">getAge@Person@@UAEHXZ</span> <span class="c1">; Person::getAge(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414232</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414233</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">aD</span>       <span class="c1">; &#34;%d\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414238</span>                 <span class="nf">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041423</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414240</span>                 <span class="nf">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414242</span>                 <span class="nf">push</span>    <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414243</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414245</span>                 <span class="nf">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414246</span>                 <span class="nf">lea</span>     <span class="no">edx</span><span class="p">,</span> <span class="no">v</span>          <span class="c1">; v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041424</span><span class="nf">C</span>                 <span class="no">call</span>    <span class="no">j_@_RTC_CheckStackVars@8</span> <span class="c1">; _RTC_CheckStackVars(x,x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414251</span>                 <span class="nf">pop</span>     <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414252</span>                 <span class="nf">pop</span>     <span class="no">edx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414253</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414254</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414255</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414256</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414259</span>                 <span class="nf">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ebp</span>        <span class="c1">; cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041425</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j_@__security_check_cookie@4</span> <span class="c1">; __security_check_cookie(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414260</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D4h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414266</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414268</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041426</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041426</span><span class="nf">F</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414270</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414270</span> <span class="c1">; ---------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414271</span>                 <span class="nf">align</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414274</span> <span class="c1">; _RTC_framedesc v
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414274</span> <span class="nf">v</span>               <span class="no">_RTC_framedesc</span> <span class="err">&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="no">offset</span> <span class="no">dword_41427C</span><span class="err">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414274</span>                                         <span class="c1">; DATA XREF: _main+56↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041427</span><span class="nf">C</span> <span class="no">dword_41427C</span>    <span class="no">dd</span> <span class="mi">0</span><span class="no">FFFFFFF0h</span><span class="p">,</span> <span class="mi">8</span>        <span class="c1">; DATA XREF: _main:v↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414284</span>                 <span class="nf">dd</span> <span class="no">offset</span> <span class="no">aPerson</span>       <span class="c1">; &#34;person&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414288</span> <span class="nf">aPerson</span>         <span class="no">db</span> <span class="err">&#39;</span><span class="no">person</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>           <span class="c1">; DATA XREF: _main+94↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414288</span> <span class="nf">_main</span>           <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="1113-析构函数分析">11.1.3 析构函数分析</h4>
<p>执行析构函数时，实际上是在还原虚表指针，让其指向自身的虚表首地址，防止在析构函数中调用虚函数时取到非自身虚表，从而导致函数调用错误。</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">~</span><span class="n">Person</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="n">getAge</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="p">(</span><span class="kt">int</span> <span class="n">age</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//虚函数定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span> <span class="n">person</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">person</span><span class="p">.</span><span class="n">setAge</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="n">getAge</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// STD4_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">PersonVtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">Person</span><span class="o">::</span><span class="err">`</span><span class="n">vftable</span><span class="err">&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;~Person()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Person</span> <span class="n">person</span><span class="p">;</span> <span class="c1">// [esp+E0h] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+F8h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::</span><span class="n">setAge</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="n">Person</span><span class="o">::</span><span class="n">getAge</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Person</span><span class="o">::~</span><span class="n">Person</span><span class="p">(</span><span class="o">&amp;</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411800</span> <span class="c1">; void __thiscall Person::~Person(Person *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411800</span> <span class="err">??1</span><span class="nf">Person@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>             <span class="c1">; CODE XREF: Person::~Person(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411800</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411800</span> <span class="nf">var_C</span>           <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411800</span> <span class="nf">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411800</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411800</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411801</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411803</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411809</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">C</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">D</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">D</span> <span class="no">__$EncStackInitStart</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">D</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411810</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411815</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">A</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">C</span> <span class="no">__$EncStackInitEnd</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">C</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 设置this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411820</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">offset</span> <span class="no">_E4C34A80_main@cpp</span> <span class="c1">; JMC_flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411825</span>                 <span class="nf">call</span>    <span class="no">j_@__CheckForDebuggerJustMyCode@4</span> <span class="c1">; __CheckForDebuggerJustMyCode(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041182</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="no">offset</span> <span class="err">??</span><span class="no">_7Person@@6B@</span> <span class="c1">; 设置虚表指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411833</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;~Person()\n&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411838</span>                 <span class="nf">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041183</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411840</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411841</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411842</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411843</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411849</span>                 <span class="nf">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041184</span><span class="nf">B</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411850</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411852</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411853</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411853</span> <span class="err">??1</span><span class="nf">Person@@QAE@XZ</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>11.2.虚函数的识别</p>
<p>判断是否为虚函数</p>
<ul>
<li>类中隐式定义了一个数据成员</li>
<li>该数据成员在首地址处，占一个指针大小</li>
<li>构造函数会将此数据成员初始化为某个数组的首地址</li>
<li>这个地址属于数据区，是相当固定的地址</li>
<li>在这个数组中，每个元素都是函数地址</li>
<li>这些函数被调用时，第一个参数是this指针</li>
<li>在这些函数内部，很有可能堆this指针使用间接的访问方式</li>
</ul>
<h2 id="12-从内存角度看继承和多重继承">12. 从内存角度看继承和多重继承</h2>
<h3 id="121-识别类与类之间的关系">12.1 识别类与类之间的关系</h3>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Base</span> <span class="p">{</span> <span class="c1">//基类定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Base</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Base</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">~</span><span class="n">Base</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;~Base</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">setNumber</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">base</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="nf">getNumber</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Derive</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Base</span> <span class="p">{</span> <span class="c1">//派生类定义
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="n">showNumber</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">setNumber</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">derive</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">getNumber</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">derive</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">derive</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Derive</span> <span class="n">derive</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">derive</span><span class="p">.</span><span class="n">showNumber</span><span class="p">(</span><span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Base</span><span class="o">::</span><span class="n">Base</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;Base</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Derive</span><span class="o">::</span><span class="n">Derive</span><span class="p">(</span><span class="n">Derive</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Base</span><span class="o">::</span><span class="n">Base</span><span class="p">((</span><span class="n">Base</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">Derive</span><span class="o">::</span><span class="n">showNumber</span><span class="p">(</span><span class="n">Derive</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Derive</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// STD8_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Base</span><span class="o">::</span><span class="n">setNumber</span><span class="p">((</span><span class="n">Base</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v2</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="o">-&gt;</span><span class="n">derive</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="n">Base</span><span class="o">::</span><span class="n">getNumber</span><span class="p">((</span><span class="n">Base</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v2</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v2</span><span class="o">-&gt;</span><span class="n">derive</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Derive</span> <span class="n">derive</span><span class="p">;</span> <span class="c1">// [esp+E0h] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+F8h] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Derive</span><span class="o">::</span><span class="n">Derive</span><span class="p">(</span><span class="o">&amp;</span><span class="n">derive</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Derive</span><span class="o">::</span><span class="n">showNumber</span><span class="p">(</span><span class="o">&amp;</span><span class="n">derive</span><span class="p">,</span> <span class="n">argc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Derive</span><span class="o">::~</span><span class="n">Derive</span><span class="p">(</span><span class="o">&amp;</span><span class="n">derive</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>虚函数的调用过程是间接寻址方式：</p>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Person</span> <span class="p">{</span> <span class="c1">// 基类——“人”类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Person</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">Person</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">showSpeak</span><span class="p">()</span> <span class="p">{}</span> <span class="c1">// 这里用纯虚函数更好，相关的知识点后面会讲到
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Chinese</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Person</span> <span class="p">{</span> <span class="c1">// 中国人：继承自人类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Chinese</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">Chinese</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">showSpeak</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 覆盖基类虚函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Speak Chinese</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">American</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Person</span> <span class="p">{</span> <span class="c1">//美国人：继承自人类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">American</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">American</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">showSpeak</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//覆盖基类虚函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Speak American</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">German</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Person</span> <span class="p">{</span> <span class="c1">//德国人：继承自人类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">German</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">German</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">showSpeak</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//覆盖基类虚函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Speak German</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">speak</span><span class="p">(</span><span class="n">Person</span><span class="o">*</span> <span class="n">person</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//根据虚表信息获取虚函数首地址并调用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">person</span><span class="o">-&gt;</span><span class="n">showSpeak</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Chinese</span> <span class="n">chinese</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">American</span> <span class="n">american</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">German</span> <span class="n">german</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">speak</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chinese</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">speak</span><span class="p">(</span><span class="o">&amp;</span><span class="n">american</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">speak</span><span class="p">(</span><span class="o">&amp;</span><span class="n">german</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">speak</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="n">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">person</span><span class="o">-&gt;</span><span class="n">vfptr</span><span class="o">-&gt;</span><span class="n">showSpeak</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">German</span> <span class="n">german</span><span class="p">;</span> <span class="c1">// [esp+E0h] [ebp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">American</span> <span class="n">american</span><span class="p">;</span> <span class="c1">// [esp+ECh] [ebp-24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Chinese</span> <span class="n">chinese</span><span class="p">;</span> <span class="c1">// [esp+F8h] [ebp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+10Ch] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Chinese</span><span class="o">::</span><span class="n">Chinese</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chinese</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">American</span><span class="o">::</span><span class="n">American</span><span class="p">(</span><span class="o">&amp;</span><span class="n">american</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">German</span><span class="o">::</span><span class="n">German</span><span class="p">(</span><span class="o">&amp;</span><span class="n">german</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">speak</span><span class="p">((</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">chinese</span><span class="p">.</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">speak</span><span class="p">((</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">american</span><span class="p">.</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">speak</span><span class="p">((</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">german</span><span class="p">.</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">German</span><span class="o">::~</span><span class="n">German</span><span class="p">(</span><span class="o">&amp;</span><span class="n">german</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">American</span><span class="o">::~</span><span class="n">American</span><span class="p">(</span><span class="o">&amp;</span><span class="n">american</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Chinese</span><span class="o">::~</span><span class="n">Chinese</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chinese</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414470</span> <span class="c1">; void __cdecl speak(Person *person)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414470</span> <span class="err">?</span><span class="nf">speak@@YAXPAVPerson@@@Z</span> <span class="no">proc</span> <span class="no">near</span>      <span class="c1">; CODE XREF: speak(Person *)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414470</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414470</span> <span class="nf">person</span>          <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414470</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414470</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414471</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414473</span>                 <span class="nf">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414479</span>                 <span class="nf">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">A</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">B</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">C</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">C</span> <span class="no">__$EncStackInitStart_14</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">C</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041447</span><span class="nf">E</span>                 <span class="no">xor</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414480</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414485</span>                 <span class="na">rep</span> <span class="nf">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414487</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414487</span> <span class="nl">__$EncStackInitEnd_14:</span>                  <span class="c1">; JMC_flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414487</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">offset</span> <span class="no">_E4C34A80_main@cpp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041448</span><span class="nf">C</span>                 <span class="no">call</span>    <span class="no">j_@__CheckForDebuggerJustMyCode@4</span> <span class="c1">; __CheckForDebuggerJustMyCode(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414491</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414494</span>                 <span class="nf">mov</span>     <span class="no">edx</span><span class="p">,</span> <span class="p">[</span><span class="no">eax</span><span class="p">]</span>      <span class="c1">; 虚表：vfptr
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00414496</span>                 <span class="nf">mov</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00414498</span>                 <span class="nf">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">person</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041449</span><span class="nf">B</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">edx</span><span class="err">+</span><span class="mi">4</span><span class="p">]</span>    <span class="c1">; 调用showSpeak方法，因为showSpeak都放在它们各自虚表起始字节为5的地方，前4字节都放着自己的析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">0041449</span><span class="nf">E</span>                 <span class="no">call</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">A0</span>                 <span class="no">cmp</span>     <span class="no">esi</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">A2</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">A7</span>                 <span class="no">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">A8</span>                 <span class="no">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">A9</span>                 <span class="no">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">AA</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">B0</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">B2</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">B7</span>                 <span class="no">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">B9</span>                 <span class="no">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">BA</span>                 <span class="no">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004144</span><span class="nf">BA</span> <span class="err">?</span><span class="no">speak@@YAXPAVPerson@@@Z</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="122-多重继承">12.2 多重继承</h3>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Sofa</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Sofa</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">color</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">Sofa</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 沙发类虚析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;virtual ~Sofa()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getColor</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 获取沙发颜色
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">color</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">sitDown</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// 沙发可以坐下休息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Sit down and rest your legs</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">protected</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">color</span><span class="p">;</span> <span class="c1">// 沙发类成员变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//定义床类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Bed</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">Bed</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">length</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">Bed</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//床类虚析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;virtual ~Bed()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getArea</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//获取床面积
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">length</span> <span class="o">*</span> <span class="n">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">sleep</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//床可以用来睡觉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;go to sleep</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">protected</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">length</span><span class="p">;</span> <span class="c1">//床类成员变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//子类沙发床定义，派生自Sofa类和Bed类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">SofaBed</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Sofa</span><span class="p">,</span> <span class="k">public</span> <span class="n">Bed</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">SofaBed</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">height</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="o">~</span><span class="n">SofaBed</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//沙发床类的虚析构函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;virtual ~SofaBed()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">sitDown</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//沙发可以坐下休息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;Sit down on the sofa bed</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">sleep</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//床可以用来睡觉
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">return</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;go to sleep on the sofa bed</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">int</span> <span class="nf">getHeight</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">protected</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 局部变量，不会在调用析构方法后再调用delete方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">SofaBed</span> <span class="n">sofabed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">vfptr_SofaBed_1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">des_SofaBed</span><span class="p">(</span><span class="n">SofaBed</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">Sofa</span><span class="o">::</span><span class="n">getColor</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">sitDown</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">getHeight</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">vfptr_SofaBed_1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">jump_des_SofaBed</span><span class="p">(</span><span class="n">SofaBed</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">Bed</span><span class="o">::</span><span class="n">getArea</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword</span> <span class="n">ptr</span> <span class="o">=&gt;</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">sleep</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">SofaBed</span><span class="p">(</span><span class="n">SofaBed</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// STD4_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Sofa</span><span class="o">::</span><span class="n">Sofa</span><span class="p">((</span><span class="n">Sofa</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Bed</span><span class="o">::</span><span class="n">Bed</span><span class="p">((</span><span class="n">Bed</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">SofaVtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">SofaBed</span><span class="o">::</span><span class="err">`</span><span class="n">vftable</span><span class="err">&#39;</span><span class="p">{</span><span class="k">for</span> <span class="err">`</span><span class="n">Sofa</span><span class="err">&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">BedVtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">SofaBed</span><span class="o">::</span><span class="err">`</span><span class="n">vftable</span><span class="err">&#39;</span><span class="p">{</span><span class="k">for</span> <span class="err">`</span><span class="n">Bed</span><span class="err">&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">height</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">SofaBed</span><span class="o">::~</span><span class="n">SofaBed</span><span class="p">(</span><span class="n">SofaBed</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// STD4_4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">SofaVtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">vfptr_SofaBed_1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span> <span class="o">=</span> <span class="p">(</span><span class="n">BedVtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">vfptr_SofaBed_2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;virtual ~SofaBed()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Bed</span><span class="o">::~</span><span class="n">Bed</span><span class="p">((</span><span class="n">Bed</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Sofa</span><span class="o">::~</span><span class="n">Sofa</span><span class="p">((</span><span class="n">Sofa</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="o">-&gt;</span><span class="n">vfptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//SofaBed *__thiscall SofaBed::`vector deleting destructor&#39;(SofaBed *this, unsigned int a2)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SofaBed</span> <span class="o">*</span><span class="n">__thiscall</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">des_SofaBed</span><span class="p">(</span><span class="n">SofaBed</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span> <span class="o">*</span><span class="n">thisa</span><span class="p">;</span> <span class="c1">// [esp+D0h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">thisa</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span><span class="o">::~</span><span class="n">SofaBed</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">a2</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">delete</span><span class="p">(</span><span class="n">thisa</span><span class="p">,</span> <span class="mh">0x18u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">thisa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// this - 8
</span></span></span><span class="line"><span class="cl"><span class="c1">//SofaBed *__thiscall SofaBed::`vector deleting destructor&#39;(char *this, unsigned int a2)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SofaBed</span> <span class="o">*</span><span class="n">__thiscall</span> <span class="n">SofaBed</span><span class="o">::</span><span class="n">jump_des_SofaBed</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="k">this</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">des_SofaBed</span><span class="p">((</span><span class="n">SofaBed</span> <span class="o">*</span><span class="p">)(</span><span class="k">this</span> <span class="o">-</span> <span class="mi">8</span><span class="p">),</span> <span class="n">a2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// ST00_8
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">SofaBed</span> <span class="n">sofabed</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">E4C34A80_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span><span class="o">::</span><span class="n">SofaBed</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sofabed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SofaBed</span><span class="o">::~</span><span class="n">SofaBed</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sofabed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span> <span class="c1">; void __thiscall SofaBed::SofaBed(SofaBed *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00415690</span> <span class="err">??0</span><span class="nf">SofaBed@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>            <span class="c1">; CODE XREF: SofaBed::SofaBed(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00415690</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span> <span class="nf">var_18</span>          <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">18</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span> <span class="nf">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">14</span><span class="no">h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span> <span class="nf">var_C</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span> <span class="nf">var_4</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415690</span>                 <span class="nf">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415691</span>                 <span class="nf">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415693</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415695</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">__ehhandler$</span><span class="err">??</span><span class="mi">0</span><span class="no">SofaBed@@QAE@XZ</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041569</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">A0</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">A1</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">A7</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">A8</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">A9</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">AA</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">AB</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">AB</span> <span class="no">__$EncStackInitStart_16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">AB</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_18</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">AE</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">B3</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">B8</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">BA</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">BA</span> <span class="no">__$EncStackInitEnd_16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">BA</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">BB</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">___security_cookie</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">C0</span>                 <span class="no">xor</span>     <span class="no">eax</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">C2</span>                 <span class="no">push</span>    <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">C3</span>                 <span class="no">lea</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">C6</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">CC</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 设置this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">CF</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">offset</span> <span class="no">_E4C34A80_main@cpp</span> <span class="c1">; JMC_flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">D4</span>                 <span class="no">call</span>    <span class="no">j_@__CheckForDebuggerJustMyCode@4</span> <span class="c1">; __CheckForDebuggerJustMyCode(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">D9</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">DC</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Sofa@@QAE@XZ</span> <span class="c1">; Sofa::Sofa(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">E1</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">E8</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; 现在this对象前4个字节保存Sofa的虚表，再之后的4个字节保存Sofa的成员变量color
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">EB</span>                 <span class="no">add</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">8</span>          <span class="c1">; this
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">EE</span>                 <span class="no">call</span>    <span class="no">j_</span><span class="err">??</span><span class="mi">0</span><span class="no">Bed@@QAE@XZ</span> <span class="c1">; Bed::Bed(void)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">F3</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span> <span class="c1">; 现在this对象前4个字节保存Sofa的虚表，再之后的4个字节保存Sofa的成员变量color
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">F3</span>                                         <span class="c1">; 再4个字节Bed的虚表，之后就是Bed的两个成员变量：length、width
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">F6</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="no">offset</span> <span class="no">vfptr_SofaBed_1</span> <span class="c1">; 将this对象前4个字节保存SofaBed_1的虚表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004156</span><span class="nf">FC</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004156</span><span class="nf">FF</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">8</span><span class="p">],</span> <span class="no">offset</span> <span class="no">vfptr_SofaBed_2</span> <span class="c1">; 将this对象前8个字节之后的4字节空间保存vfptr_SofaBed_2的虚表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00415706</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415709</span>                 <span class="nf">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="err">+</span><span class="mi">14</span><span class="no">h</span><span class="p">],</span> <span class="mi">6</span> <span class="c1">; this-&gt;height = 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00415710</span>                 <span class="nf">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_4</span><span class="p">],</span> <span class="mi">0</span><span class="no">FFFFFFFFh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415717</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041571</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041571</span><span class="nf">D</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415724</span>                 <span class="nf">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415725</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415726</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415727</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415728</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">D8h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041572</span><span class="nf">E</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415730</span>                 <span class="nf">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415735</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415737</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415738</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00415738</span> <span class="err">??0</span><span class="nf">SofaBed@@QAE@XZ</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过反汇编分析，sofabed对象前4个字节保存SofaBed_1的虚表，再之后的4个字节保存Sofa的成员变量color，再之后的4个字节保存vfptr_SofaBed_2的虚表，之后就是Bed的两个成员变量：length、width；最后4个字节保存SofaBed成员变量height，所以对象的大小为24字节。</p>
<p><strong>单继承类和多重继承类特征总结</strong></p>
<p>单继承</p>
<ul>
<li>在类对象占用的内存空间中，只保存一份虚表指针。</li>
<li>因为只有一个虚表指针，所以只有一个虚表。</li>
<li>虚表中各项保存了类中各虚函数的首地址。</li>
<li>构造时先构造父类，再构造自身，并且只调用一次父类构造函数。</li>
<li>析构时先析构自身，再析构父类，并且只调用一次父类析构函数</li>
</ul>
<p>多重继承</p>
<ul>
<li>在类对象占用内存空间中，根据继承父类（有虚函数）个数保存对应的虚表指针。</li>
<li>根据保存的虚表指针的个数，产生相应个数的虚表。</li>
<li>转换父类指针时，需要调整到对象的首地址。</li>
<li>构造时需要调用多个父类构造函数。</li>
<li>构造时先构造继承列表中的第一个父类，然后依次调用到最后一个继承的父类构造函数。</li>
<li>析构时先析构自身，然后以构造函数相反的顺序调用所有父类的析构函数。</li>
<li>当对象作为成员时，整个类对象的内存结构和多重继承相似。当类中无虚函数时，整个类对象内存结构和多重继承完全一样，可酌情还原。当父类或成员对象存在虚函数时，通过观察虚表指针的位置和构造、析构函数中填写虚表指针的数目、顺序及目标地址，还原继承或成员关系。</li>
</ul>
<h3 id="123-抽象类">12.3 抽象类</h3>
<p>debug</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">AbstractBase</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">AbstractBase</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;AbstractBase()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="nf">show</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//定义纯虚函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">VirtualChild</span> <span class="o">:</span> <span class="k">public</span> <span class="n">AbstractBase</span> <span class="p">{</span> <span class="c1">//定义继承抽象类的子类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">virtual</span> <span class="kt">void</span> <span class="n">show</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//实现纯虚函数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;抽象类分析</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">VirtualChild</span> <span class="n">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">obj</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">__thiscall</span> <span class="n">AbstractBase</span><span class="o">::</span><span class="n">AbstractBase</span><span class="p">(</span><span class="n">AbstractBase</span> <span class="o">*</span><span class="k">this</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">__CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="mf">070E5</span><span class="n">FD3_main_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">-&gt;</span><span class="n">__vftable</span> <span class="o">=</span> <span class="p">(</span><span class="n">AbstractBase_vtbl</span> <span class="o">*</span><span class="p">)</span><span class="n">AbstractBase</span><span class="o">::</span><span class="err">`</span><span class="n">vftable</span><span class="err">&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">j__printf</span><span class="p">(</span><span class="s">&#34;AbstractBase()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B34</span> <span class="err">??</span><span class="no">_7AbstractBase@@6B@</span> <span class="no">dd</span> <span class="no">offset</span> <span class="no">j___purecall</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B34</span>                                         <span class="c1">; DATA XREF: AbstractBase::AbstractBase(void)+2D↑o
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B38</span>                 <span class="no">db</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B39</span>                 <span class="no">db</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B3A</span>                 <span class="no">db</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.rdata:</span><span class="err">00417</span><span class="nf">B3B</span>                 <span class="no">db</span>    <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span> <span class="c1">; void __thiscall AbstractBase::AbstractBase(AbstractBase *this)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span> <span class="err">??</span><span class="mi">0</span><span class="no">AbstractBase@@QAE@XZ</span> <span class="no">proc</span> <span class="no">near</span>       <span class="c1">; CODE XREF: AbstractBase::AbstractBase(void)↑j
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span> <span class="no">var_C</span>           <span class="err">=</span> <span class="no">byte</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">0</span><span class="no">Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span> <span class="no">this</span>            <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="p">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D0</span>                 <span class="no">push</span>    <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D1</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D3</span>                 <span class="no">sub</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">D9</span>                 <span class="no">push</span>    <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DA</span>                 <span class="no">push</span>    <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DB</span>                 <span class="no">push</span>    <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DC</span>                 <span class="no">push</span>    <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DD</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DD</span> <span class="no">__$EncStackInitStart</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">DD</span>                 <span class="no">lea</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">var_C</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">E0</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">E5</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCCCCCCCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">EA</span>                 <span class="no">rep</span> <span class="no">stosd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">EC</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">EC</span> <span class="no">__$EncStackInitEnd</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">EC</span>                 <span class="no">pop</span>     <span class="no">ecx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">ED</span>                 <span class="no">mov</span>     <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">],</span> <span class="no">ecx</span> <span class="c1">; 设置this指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F0</span>                 <span class="no">mov</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">offset</span> <span class="no">_070E5FD3_main@cpp</span> <span class="c1">; JMC_flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">F5</span>                 <span class="no">call</span>    <span class="no">j_@__CheckForDebuggerJustMyCode@4</span> <span class="c1">; __CheckForDebuggerJustMyCode(x)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">004117</span><span class="nf">FA</span>                 <span class="no">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">004117</span><span class="nf">FD</span>                 <span class="no">mov</span>     <span class="no">dword</span> <span class="no">ptr</span> <span class="p">[</span><span class="no">eax</span><span class="p">],</span> <span class="no">offset</span> <span class="err">??</span><span class="no">_7AbstractBase@@6B@</span> <span class="c1">; const AbstractBase::`vftable&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411803</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">_Format</span>  <span class="c1">; &#34;AbstractBase()&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nl">.text:</span><span class="err">00411808</span>                 <span class="nf">call</span>    <span class="no">j__printf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041180</span><span class="nf">D</span>                 <span class="no">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411810</span>                 <span class="nf">mov</span>     <span class="no">eax</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">this</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411813</span>                 <span class="nf">pop</span>     <span class="no">edi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411814</span>                 <span class="nf">pop</span>     <span class="no">esi</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411815</span>                 <span class="nf">pop</span>     <span class="no">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411816</span>                 <span class="nf">add</span>     <span class="no">esp</span><span class="p">,</span> <span class="mi">0</span><span class="no">CCh</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">C</span>                 <span class="no">cmp</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0041181</span><span class="nf">E</span>                 <span class="no">call</span>    <span class="no">j___RTC_CheckEsp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411823</span>                 <span class="nf">mov</span>     <span class="no">esp</span><span class="p">,</span> <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411825</span>                 <span class="nf">pop</span>     <span class="no">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411826</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">00411826</span> <span class="err">??0</span><span class="nf">AbstractBase@@QAE@XZ</span> <span class="no">endp</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在抽象类的虚表信息中，因为纯虚函数没有实现代码，所以没有首地址，编译器为了防止误调用虚函数，将虚表中保存的纯虚函数的首地址项替换成函数<code>__purecall</code>，用于结束程序。在分析过程中，一旦在虚表中发现函数地址为<code>__purecall</code>函数时，就可以高度怀疑此虚表对应的类是一个抽象类。</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2023-02-07&#32;00:00:00>Updated on 2023-02-07&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98/" data-title="c&#43;&#43;反汇编揭秘" data-hashtags="c/c&#43;&#43;"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98/" data-hashtag="c/c&#43;&#43;"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://cui-jiang-tao.github.io/posts/c&#43;&#43;%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8F%AD%E7%A7%98/" data-title="c&#43;&#43;反汇编揭秘"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/c/c&#43;&#43;/' class="post-tag">c/c&#43;&#43;</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E6%BB%B4%E6%B0%B4%E4%B8%89%E6%9C%9F/" class="post-nav-item" rel="prev" title="PE"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>PE</a>
      <a href="/posts/c&#43;&#43;%E5%B0%8F%E5%B7%A5%E5%85%B7/" class="post-nav-item" rel="next" title="c&#43;&#43;小工具">c&#43;&#43;小工具<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2023</span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Theme FixIt works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/lazysizes/lazysizes.min.js" async defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":-1},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"typeit-header-desktop":"Home","typeit-header-title-mobile":"Home"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"typeit-header-desktop":["typeit-header-desktop"],"typeit-header-title-mobile":["typeit-header-title-mobile"]},"duration":-1,"speed":100}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
